(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86836,e=>{"use strict";let t,n;e.s(["default",()=>nh],86836);var l,i,r,o,a,s,u,p,c,d,f,m,h,g,y,C,v,T,E,A,_,O,I,S,b,R,N,P,M,D,x,w,U,k,q,L,G,H,F,j,V,J,B,Y,W,K,z,X=e.i(43476),Q=e.i(71645);e.i(9699);var Z=e.i(5519),$=e.i(5766);class ee{}function et(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){let e=t[n];return null!=e?String(e):""}throw Error("Key '".concat(n,"' not found in valueMap."))})}function en(e,t,n){for(let l=0;l<t.length-1;l++){let i=t[l];if(i.endsWith("[]")){let r=i.slice(0,-2);if(!(r in e))if(Array.isArray(n))e[r]=Array.from({length:n.length},()=>({}));else throw Error("Value must be a list given an array path ".concat(i));if(Array.isArray(e[r])){let i=e[r];if(Array.isArray(n))for(let e=0;e<i.length;e++)en(i[e],t.slice(l+1),n[e]);else for(let e of i)en(e,t.slice(l+1),n)}return}if(i.endsWith("[0]")){let r=i.slice(0,-3);r in e||(e[r]=[{}]),en(e[r][0],t.slice(l+1),n);return}e[i]&&"object"==typeof e[i]||(e[i]={}),e=e[i]}let l=t[t.length-1],i=e[l];if(void 0!==i){if(!n||"object"==typeof n&&0===Object.keys(n).length||n===i)return;if("object"==typeof i&&"object"==typeof n&&null!==i&&null!==n)Object.assign(i,n);else throw Error("Cannot set value for an existing key. Key: ".concat(l))}else e[l]=n}function el(e,t){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return;let l=t[n];if(l.endsWith("[]")){let i=l.slice(0,-2);if(!(i in e))return;{let l=e[i];if(!Array.isArray(l))return;return l.map(e=>el(e,t.slice(n+1)))}}e=e[l]}return e}catch(e){if(e instanceof TypeError)return;throw e}}function ei(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e}!function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(l||(l={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(i||(i={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"}(r||(r={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"}(o||(o={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(a||(a={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(s||(s={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(u||(u={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(p||(p={})),function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"}(c||(c={})),function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(d||(d={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"}(f||(f={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(m||(m={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(h||(h={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"}(g||(g={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(y||(y={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(C||(C={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(v||(v={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(T||(T={})),function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(E||(E={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(A||(A={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(_||(_={})),function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"}(O||(O={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(I||(I={})),function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(S||(S={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"}(b||(b={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(R||(R={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(N||(N={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"}(P||(P={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(M||(M={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(D||(D={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(x||(x={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(w||(w={})),function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"}(U||(U={})),function(e){e.ASSET="ASSET",e.STYLE="STYLE"}(k||(k={})),function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"}(q||(q={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(L||(L={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"}(G||(G={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(H||(H={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(F||(F={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(j||(j={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(V||(V={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(J||(J={})),function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"}(B||(B={})),function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(Y||(Y={})),function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"}(W||(W={})),function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"}(K||(K={}));class er{json(){return this.responseInternal.json()}constructor(e){let t={};for(let n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}}class eo{get text(){var e,t,n,l,i,r,o,a;if((null==(l=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let s="",u=!1,p=[];for(let e of null!=(a=null==(o=null==(r=null==(i=this.candidates)?void 0:i[0])?void 0:r.content)?void 0:o.parts)?a:[]){for(let[t,n]of Object.entries(e))"text"!==t&&"thought"!==t&&(null!==n||void 0!==n)&&p.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,s+=e.text}}return p.length>0&&console.warn("there are non-text parts ".concat(p," in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.")),u?s:void 0}get data(){var e,t,n,l,i,r,o,a;if((null==(l=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let s="",u=[];for(let e of null!=(a=null==(o=null==(r=null==(i=this.candidates)?void 0:i[0])?void 0:r.content)?void 0:o.parts)?a:[]){for(let[t,n]of Object.entries(e))"inlineData"!==t&&(null!==n||void 0!==n)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(s+=atob(e.inlineData.data))}return u.length>0&&console.warn("there are non-data parts ".concat(u," in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.")),s.length>0?btoa(s):void 0}get functionCalls(){var e,t,n,l,i,r,o,a;if((null==(l=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let s=null==(a=null==(o=null==(r=null==(i=this.candidates)?void 0:i[0])?void 0:r.content)?void 0:o.parts)?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==s?void 0:s.length)!==0)return s}get executableCode(){var e,t,n,l,i,r,o,a,s;if((null==(l=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null==(a=null==(o=null==(r=null==(i=this.candidates)?void 0:i[0])?void 0:r.content)?void 0:o.parts)?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(s=null==u?void 0:u[0])?void 0:s.code}get codeExecutionResult(){var e,t,n,l,i,r,o,a,s;if((null==(l=null==(n=null==(t=null==(e=this.candidates)?void 0:e[0])?void 0:t.content)?void 0:n.parts)?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null==(a=null==(o=null==(r=null==(i=this.candidates)?void 0:i[0])?void 0:r.content)?void 0:o.parts)?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null==(s=null==u?void 0:u[0])?void 0:s.output}}class ea{}class es{}class eu{}class ep{}class ec{}class ed{}class ef{}class em{}class eh{}class eg{}class ey{}class eC{_fromAPIResponse(e){let{apiResponse:t,isVertexAI:n}=e,l=new eC;if(l.name=t.name,l.metadata=t.metadata,l.done=t.done,l.error=t.error,n){let e=t.response;if(e){let t=new ey,n=e.videos;t.generatedVideos=null==n?void 0:n.map(e=>({video:{uri:e.gcsUri,videoBytes:e.bytesBase64Encoded?ei(e.bytesBase64Encoded):void 0,mimeType:e.mimeType}})),t.raiMediaFilteredCount=e.raiMediaFilteredCount,t.raiMediaFilteredReasons=e.raiMediaFilteredReasons,l.response=t}}else{let e=t.response;if(e){let t=new ey,n=e.generateVideoResponse,i=null==n?void 0:n.generatedSamples;t.generatedVideos=null==i?void 0:i.map(e=>{let t=e.video;return{video:{uri:null==t?void 0:t.uri,videoBytes:(null==t?void 0:t.encodedVideo)?ei(null==t?void 0:t.encodedVideo):void 0,mimeType:e.encoding}}}),t.raiMediaFilteredCount=null==n?void 0:n.raiMediaFilteredCount,t.raiMediaFilteredReasons=null==n?void 0:n.raiMediaFilteredReasons,l.response=t}}return l}}class ev{}class eT{}class eE{}class eA{}class e_{}class eO{}class eI{}class eS{get text(){var e,t,n;let l="",i=!1,r=[];for(let o of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&r.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;i=!0,l+=o.text}}return r.length>0&&console.warn("there are non-text parts ".concat(r," in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.")),i?l:void 0}get data(){var e,t,n;let l="",i=[];for(let r of null!=(n=null==(t=null==(e=this.serverContent)?void 0:e.modelTurn)?void 0:t.parts)?n:[]){for(let[e,t]of Object.entries(r))"inlineData"!==e&&null!==t&&i.push(e);r.inlineData&&"string"==typeof r.inlineData.data&&(l+=atob(r.inlineData.data))}return i.length>0&&console.warn("there are non-data parts ".concat(i," in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.")),l.length>0?btoa(l):void 0}}class eb{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function eR(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(e.isVertexAI())if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;else{if(!(t.indexOf("/")>=0))return"publishers/google/models/".concat(t);let e=t.split("/",2);return"publishers/".concat(e[0],"/models/").concat(e[1])}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:"models/".concat(t)}function eN(e,t){let n=eR(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(n):n.startsWith("models/")&&e.isVertexAI()?"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/publishers/google/").concat(n):n:""}function eP(e){return Array.isArray(e)?e.map(e=>eM(e)):[eM(e)]}function eM(e){if("object"==typeof e&&null!==e)return e;throw Error("Could not parse input as Blob. Unsupported blob type: ".concat(typeof e))}function eD(e){let t=eM(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error("Unsupported mime type: ".concat(t.mimeType))}function ex(e){let t=eM(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error("Unsupported mime type: ".concat(t.mimeType))}function ew(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error("Unsupported part type: ".concat(typeof e))}function eU(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>ew(e)):[ew(e)]}function ek(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function eq(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function eL(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function eG(e){if(null==e)throw Error("ContentUnion is required");return ek(e)?e:{role:"user",parts:eU(e)}}function eH(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=eG(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){let e=eG(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>eG(e)):[eG(t)]}function eF(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(eq(e)||eL(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[eG(e)]}let t=[],n=[],l=ek(e[0]);for(let i of e){let e=ek(i);if(e!=l)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(i);else if(eq(i)||eL(i))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else n.push(i)}return l||t.push({role:"user",parts:eU(n)}),t}function ej(e){let t={},n=["items"],l=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let o=e.anyOf;for(let[a,s]of(null!=o&&2==o.length&&("null"===o[0].type?(t.nullable=!0,e=o[1]):"null"===o[1].type&&(t.nullable=!0,e=o[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(r).includes(n[0].toUpperCase())?n[0].toUpperCase():r.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],n))t.anyOf.push({type:Object.values(r).includes(e.toUpperCase())?e.toUpperCase():r.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=s)if("type"==a){if("null"===s)throw Error("type: null can not be the only possible type for the field.");if(s instanceof Array)continue;t.type=Object.values(r).includes(s.toUpperCase())?s.toUpperCase():r.TYPE_UNSPECIFIED}else if(n.includes(a))t[a]=ej(s);else if(l.includes(a)){let e=[];for(let n of s){if("null"==n.type){t.nullable=!0;continue}e.push(ej(n))}t[a]=e}else if(i.includes(a)){let e={};for(let[t,n]of Object.entries(s))e[t]=ej(n);t[a]=e}else{if("additionalProperties"===a)continue;t[a]=s}return t}function eV(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error("Unsupported speechConfig type: ".concat(typeof e))}function eJ(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function eB(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=ej(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=ej(t.response));return e}function eY(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let n of e)t.push(n);return t}function eW(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,n){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!t.startsWith("".concat(n,"/"))&&t.split("/").length===l;if(e.isVertexAI())if(t.startsWith("projects/"))return t;else if(t.startsWith("locations/"))return"projects/".concat(e.getProject(),"/").concat(t);else if(t.startsWith("".concat(n,"/")))return"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(t);else if(i)return"projects/".concat(e.getProject(),"/locations/").concat(e.getLocation(),"/").concat(n,"/").concat(t);else return t;return i?"".concat(n,"/").concat(t):t}(e,t,"cachedContents")}function eK(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function ez(e){var t;let n;if(null!=e&&"object"==typeof e&&"name"in e&&(n=e.name),null==e||"object"!=typeof e||!("uri"in e)||void 0!==(n=e.uri)){if(null==e||"object"!=typeof e||!("video"in e)||void 0!==(n=null==(t=e.video)?void 0:t.uri)){if("string"==typeof e&&(n=e),void 0===n)throw Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){let e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error("Could not extract file name from URI ".concat(n));n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}}function eX(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function eQ(e){for(let l of["models","tunedModels","publisherModels"]){var t,n;if(t=e,n=l,null!==t&&"object"==typeof t&&n in t)return e[l]}return[]}function eZ(e,t){if("string"==typeof t||Array.isArray(t)){if(Array.isArray(t))return{inlinedRequests:t};else if("string"==typeof t){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};else if(t.startsWith("files/"))return{fileName:t}}}else{if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw Error("Only one of `gcsUri` or `bigqueryUri` can be set.");else if(!t.gcsUri&&!t.bigqueryUri)throw Error("One of `gcsUri` or `bigqueryUri` must be set.")}else if(t.inlinedRequests&&t.fileName)throw Error("Only one of `inlinedRequests` or `fileName` can be set.");else if(!t.inlinedRequests&&!t.fileName)throw Error("One of `inlinedRequests` or `fileName` must be set.");return t}throw Error("Unsupported source: ".concat(t))}function e$(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error("Invalid batch job name: ".concat(t,"."))}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error("Invalid batch job name: ".concat(t,"."))}function e0(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";else return e}function e1(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}function e2(e){let t={},n=el(e,["prebuiltVoiceConfig"]);return null!=n&&en(t,["prebuiltVoiceConfig"],function(e){let t={},n=el(e,["voiceName"]);return null!=n&&en(t,["voiceName"],n),t}(n)),t}function e6(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["src"]);null!=i&&en(n,["batch","inputConfig"],function(e,t){let n={};if(void 0!==el(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==el(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==el(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let l=el(t,["fileName"]);null!=l&&en(n,["fileName"],l);let i=el(t,["inlinedRequests"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["request","model"],eR(e,l));let i=el(t,["contents"]);if(null!=i){let e=eF(i);Array.isArray(e)&&(e=e.map(e=>e1(e))),en(n,["request","contents"],e)}let r=el(t,["config"]);return null!=r&&en(n,["request","generationConfig"],function(e,t,n){let l={},i=el(t,["systemInstruction"]);void 0!==n&&null!=i&&en(n,["systemInstruction"],e1(eG(i)));let r=el(t,["temperature"]);null!=r&&en(l,["temperature"],r);let o=el(t,["topP"]);null!=o&&en(l,["topP"],o);let a=el(t,["topK"]);null!=a&&en(l,["topK"],a);let s=el(t,["candidateCount"]);null!=s&&en(l,["candidateCount"],s);let u=el(t,["maxOutputTokens"]);null!=u&&en(l,["maxOutputTokens"],u);let p=el(t,["stopSequences"]);null!=p&&en(l,["stopSequences"],p);let c=el(t,["responseLogprobs"]);null!=c&&en(l,["responseLogprobs"],c);let d=el(t,["logprobs"]);null!=d&&en(l,["logprobs"],d);let f=el(t,["presencePenalty"]);null!=f&&en(l,["presencePenalty"],f);let m=el(t,["frequencyPenalty"]);null!=m&&en(l,["frequencyPenalty"],m);let h=el(t,["seed"]);null!=h&&en(l,["seed"],h);let g=el(t,["responseMimeType"]);null!=g&&en(l,["responseMimeType"],g);let y=el(t,["responseSchema"]);null!=y&&en(l,["responseSchema"],function(e){let t={},n=el(e,["anyOf"]);null!=n&&en(t,["anyOf"],n);let l=el(e,["default"]);null!=l&&en(t,["default"],l);let i=el(e,["description"]);null!=i&&en(t,["description"],i);let r=el(e,["enum"]);null!=r&&en(t,["enum"],r);let o=el(e,["example"]);null!=o&&en(t,["example"],o);let a=el(e,["format"]);null!=a&&en(t,["format"],a);let s=el(e,["items"]);null!=s&&en(t,["items"],s);let u=el(e,["maxItems"]);null!=u&&en(t,["maxItems"],u);let p=el(e,["maxLength"]);null!=p&&en(t,["maxLength"],p);let c=el(e,["maxProperties"]);null!=c&&en(t,["maxProperties"],c);let d=el(e,["maximum"]);null!=d&&en(t,["maximum"],d);let f=el(e,["minItems"]);null!=f&&en(t,["minItems"],f);let m=el(e,["minLength"]);null!=m&&en(t,["minLength"],m);let h=el(e,["minProperties"]);null!=h&&en(t,["minProperties"],h);let g=el(e,["minimum"]);null!=g&&en(t,["minimum"],g);let y=el(e,["nullable"]);null!=y&&en(t,["nullable"],y);let C=el(e,["pattern"]);null!=C&&en(t,["pattern"],C);let v=el(e,["properties"]);null!=v&&en(t,["properties"],v);let T=el(e,["propertyOrdering"]);null!=T&&en(t,["propertyOrdering"],T);let E=el(e,["required"]);null!=E&&en(t,["required"],E);let A=el(e,["title"]);null!=A&&en(t,["title"],A);let _=el(e,["type"]);return null!=_&&en(t,["type"],_),t}(ej(y)));let C=el(t,["responseJsonSchema"]);if(null!=C&&en(l,["responseJsonSchema"],C),void 0!==el(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==el(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let v=el(t,["safetySettings"]);if(void 0!==n&&null!=v){let e=v;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==el(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let n=el(e,["category"]);null!=n&&en(t,["category"],n);let l=el(e,["threshold"]);return null!=l&&en(t,["threshold"],l),t})(e))),en(n,["safetySettings"],e)}let T=el(t,["tools"]);if(void 0!==n&&null!=T){let e=eY(T);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["behavior"]);null!=n&&en(t,["behavior"],n);let l=el(e,["description"]);null!=l&&en(t,["description"],l);let i=el(e,["name"]);null!=i&&en(t,["name"],i);let r=el(e,["parameters"]);null!=r&&en(t,["parameters"],r);let o=el(e,["parametersJsonSchema"]);null!=o&&en(t,["parametersJsonSchema"],o);let a=el(e,["response"]);null!=a&&en(t,["response"],a);let s=el(e,["responseJsonSchema"]);return null!=s&&en(t,["responseJsonSchema"],s),t})(e))),en(t,["functionDeclarations"],e)}if(void 0!==el(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let l=el(e,["googleSearch"]);null!=l&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);if(null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n)),void 0!==el(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(l));let i=el(e,["googleSearchRetrieval"]);if(null!=i&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(i)),void 0!==el(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==el(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let r=el(e,["computerUse"]);null!=r&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(r));let o=el(e,["codeExecution"]);return null!=o&&en(t,["codeExecution"],o),t})(eB(e)))),en(n,["tools"],e)}let E=el(t,["toolConfig"]);if(void 0!==n&&null!=E&&en(n,["toolConfig"],function(e){let t={},n=el(e,["functionCallingConfig"]);null!=n&&en(t,["functionCallingConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["allowedFunctionNames"]);return null!=l&&en(t,["allowedFunctionNames"],l),t}(n));let l=el(e,["retrievalConfig"]);return null!=l&&en(t,["retrievalConfig"],function(e){let t={},n=el(e,["latLng"]);null!=n&&en(t,["latLng"],function(e){let t={},n=el(e,["latitude"]);null!=n&&en(t,["latitude"],n);let l=el(e,["longitude"]);return null!=l&&en(t,["longitude"],l),t}(n));let l=el(e,["languageCode"]);return null!=l&&en(t,["languageCode"],l),t}(l)),t}(E)),void 0!==el(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let A=el(t,["cachedContent"]);void 0!==n&&null!=A&&en(n,["cachedContent"],eW(e,A));let _=el(t,["responseModalities"]);null!=_&&en(l,["responseModalities"],_);let O=el(t,["mediaResolution"]);null!=O&&en(l,["mediaResolution"],O);let I=el(t,["speechConfig"]);if(null!=I&&en(l,["speechConfig"],function(e){let t={},n=el(e,["voiceConfig"]);null!=n&&en(t,["voiceConfig"],e2(n));let l=el(e,["multiSpeakerVoiceConfig"]);null!=l&&en(t,["multiSpeakerVoiceConfig"],function(e){let t={},n=el(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["speaker"]);null!=n&&en(t,["speaker"],n);let l=el(e,["voiceConfig"]);return null!=l&&en(t,["voiceConfig"],e2(l)),t})(e))),en(t,["speakerVoiceConfigs"],e)}return t}(l));let i=el(e,["languageCode"]);return null!=i&&en(t,["languageCode"],i),t}(eV(I))),void 0!==el(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let S=el(t,["thinkingConfig"]);return null!=S&&en(l,["thinkingConfig"],function(e){let t={},n=el(e,["includeThoughts"]);null!=n&&en(t,["includeThoughts"],n);let l=el(e,["thinkingBudget"]);return null!=l&&en(t,["thinkingBudget"],l),t}(S)),l}(e,r,n)),n})(e,t))),en(n,["requests","requests"],t)}return n}(e,eZ(e,i)));let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){let n=el(e,["displayName"]);if(void 0!==t&&null!=n&&en(t,["batch","displayName"],n),void 0!==el(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.");return{}}(r,n)),n}function e3(e){let t={},n=el(e,["details"]);null!=n&&en(t,["details"],n);let l=el(e,["code"]);null!=l&&en(t,["code"],l);let i=el(e,["message"]);return null!=i&&en(t,["message"],i),t}function e4(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["metadata","displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["metadata","state"]);null!=i&&en(t,["state"],e0(i));let r=el(e,["metadata","createTime"]);null!=r&&en(t,["createTime"],r);let o=el(e,["metadata","endTime"]);null!=o&&en(t,["endTime"],o);let a=el(e,["metadata","updateTime"]);null!=a&&en(t,["updateTime"],a);let s=el(e,["metadata","model"]);null!=s&&en(t,["model"],s);let u=el(e,["metadata","output"]);return null!=u&&en(t,["dest"],function(e){let t={},n=el(e,["responsesFile"]);null!=n&&en(t,["fileName"],n);let l=el(e,["inlinedResponses","inlinedResponses"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["response"]);null!=n&&en(t,["response"],function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["candidates"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["content"]);null!=n&&en(t,["content"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(n));let l=el(e,["citationMetadata"]);null!=l&&en(t,["citationMetadata"],function(e){let t={},n=el(e,["citationSources"]);return null!=n&&en(t,["citations"],n),t}(l));let i=el(e,["tokenCount"]);null!=i&&en(t,["tokenCount"],i);let r=el(e,["finishReason"]);null!=r&&en(t,["finishReason"],r);let o=el(e,["urlContextMetadata"]);null!=o&&en(t,["urlContextMetadata"],function(e){let t={},n=el(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["retrievedUrl"]);null!=n&&en(t,["retrievedUrl"],n);let l=el(e,["urlRetrievalStatus"]);return null!=l&&en(t,["urlRetrievalStatus"],l),t})(e))),en(t,["urlMetadata"],e)}return t}(o));let a=el(e,["avgLogprobs"]);null!=a&&en(t,["avgLogprobs"],a);let s=el(e,["groundingMetadata"]);null!=s&&en(t,["groundingMetadata"],s);let u=el(e,["index"]);null!=u&&en(t,["index"],u);let p=el(e,["logprobsResult"]);null!=p&&en(t,["logprobsResult"],p);let c=el(e,["safetyRatings"]);return null!=c&&en(t,["safetyRatings"],c),t})(e))),en(t,["candidates"],e)}let i=el(e,["modelVersion"]);null!=i&&en(t,["modelVersion"],i);let r=el(e,["promptFeedback"]);null!=r&&en(t,["promptFeedback"],r);let o=el(e,["responseId"]);null!=o&&en(t,["responseId"],o);let a=el(e,["usageMetadata"]);return null!=a&&en(t,["usageMetadata"],a),t}(n));let l=el(e,["error"]);return null!=l&&en(t,["error"],e3(l)),t})(e))),en(t,["inlinedResponses"],e)}return t}(u)),t}function e5(e){let t={},n=el(e,["details"]);null!=n&&en(t,["details"],n);let l=el(e,["code"]);null!=l&&en(t,["code"],l);let i=el(e,["message"]);return null!=i&&en(t,["message"],i),t}function e8(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["state"]);null!=i&&en(t,["state"],e0(i));let r=el(e,["error"]);null!=r&&en(t,["error"],e5(r));let o=el(e,["createTime"]);null!=o&&en(t,["createTime"],o);let a=el(e,["startTime"]);null!=a&&en(t,["startTime"],a);let s=el(e,["endTime"]);null!=s&&en(t,["endTime"],s);let u=el(e,["updateTime"]);null!=u&&en(t,["updateTime"],u);let p=el(e,["model"]);null!=p&&en(t,["model"],p);let c=el(e,["inputConfig"]);null!=c&&en(t,["src"],function(e){let t={},n=el(e,["instancesFormat"]);null!=n&&en(t,["format"],n);let l=el(e,["gcsSource","uris"]);null!=l&&en(t,["gcsUri"],l);let i=el(e,["bigquerySource","inputUri"]);return null!=i&&en(t,["bigqueryUri"],i),t}(c));let d=el(e,["outputConfig"]);return null!=d&&en(t,["dest"],function(e){let t={},n=el(e,["predictionsFormat"]);null!=n&&en(t,["format"],n);let l=el(e,["gcsDestination","outputUriPrefix"]);null!=l&&en(t,["gcsUri"],l);let i=el(e,["bigqueryDestination","outputUri"]);return null!=i&&en(t,["bigqueryUri"],i),t}(d)),t}!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"}(z||(z={}));class e9{init(e,t,n){var l,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let r={config:{}};(r=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}}).config&&(r.config.pageToken=t.nextPageToken),this.paramsInternal=r,this.pageInternalSize=null!=(i=null==(l=r.config)?void 0:l.pageSize)?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null==(e=this.params.config)?void 0:e.pageToken)!==void 0}constructor(e,t,n,l){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,l)}}class e7 extends ee{async createInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["model"],eR(e,l));let i=el(t,["src"]);null!=i&&en(n,["inputConfig"],function(e){let t={},n=el(e,["format"]);null!=n&&en(t,["instancesFormat"],n);let l=el(e,["gcsUri"]);null!=l&&en(t,["gcsSource","uris"],l);let i=el(e,["bigqueryUri"]);if(null!=i&&en(t,["bigquerySource","inputUri"],i),void 0!==el(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==el(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(eZ(e,i)));let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){let n=el(e,["displayName"]);void 0!==t&&null!=n&&en(t,["displayName"],n);let l=el(e,["dest"]);return void 0!==t&&null!=l&&en(t,["outputConfig"],function(e){let t={},n=el(e,["format"]);null!=n&&en(t,["predictionsFormat"],n);let l=el(e,["gcsUri"]);null!=l&&en(t,["gcsDestination","outputUriPrefix"],l);let i=el(e,["bigqueryUri"]);if(null!=i&&en(t,["bigqueryDestination","outputUri"],i),void 0!==el(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==el(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error("Unsupported destination: ".concat(e))}(l))),{}}(r,n)),n}(this.apiClient,e);return r=et("batchPredictionJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e8(e))}{let t=e6(this.apiClient,e);return r=et("{model}:batchGenerateContent",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e4(e))}}async get(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],e$(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("batchPredictionJobs/{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e8(e))}{let t=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],e$(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("batches/{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e4(e))}}async cancel(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],e$(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);r=et("batchPredictionJobs/{name}:cancel",l._url),o=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}else{let t=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],e$(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);r=et("batches/{name}:cancel",t._url),o=t._query,delete t.config,delete t._url,delete t._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal})}}async listInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e){let t={},n=el(e,["config"]);return null!=n&&en(t,["config"],function(e,t){let n=el(e,["pageSize"]);void 0!==t&&null!=n&&en(t,["_query","pageSize"],n);let l=el(e,["pageToken"]);void 0!==t&&null!=l&&en(t,["_query","pageToken"],l);let i=el(e,["filter"]);return void 0!==t&&null!=i&&en(t,["_query","filter"],i),{}}(n,t)),t}(e);return r=et("batchPredictionJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["batchPredictionJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e8(e))),en(t,["batchJobs"],e)}return t}(e),n=new eI;return Object.assign(n,t),n})}{let t=function(e){let t={},n=el(e,["config"]);return null!=n&&en(t,["config"],function(e,t){let n=el(e,["pageSize"]);void 0!==t&&null!=n&&en(t,["_query","pageSize"],n);let l=el(e,["pageToken"]);if(void 0!==t&&null!=l&&en(t,["_query","pageToken"],l),void 0!==el(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.");return{}}(n,t)),t}(e);return r=et("batches",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["operations"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e4(e))),en(t,["batchJobs"],e)}return t}(e),n=new eI;return Object.assign(n,t),n})}}async delete(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],e$(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("batchPredictionJobs/{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["done"]);null!=i&&en(t,["done"],i);let r=el(e,["error"]);return null!=r&&en(t,["error"],e5(r)),t})(e))}{let t=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],e$(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("batches/{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["done"]);null!=i&&en(t,["done"],i);let r=el(e,["error"]);return null!=r&&en(t,["error"],e3(r)),t})(e))}}constructor(e){var t;super(),t=this,this.apiClient=e,this.create=async e=>{var t,n;if(this.apiClient.isVertexAI()){let t=Date.now().toString();if(Array.isArray(e.src))throw Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(e.config=e.config||{},void 0===e.config.displayName&&(e.config.displayName="genaiBatchJob_${timestampStr}"),void 0===e.config.dest&&"string"==typeof e.src)if(e.src.startsWith("gs://")&&e.src.endsWith(".jsonl"))e.config.dest="".concat(e.src.slice(0,-6),"/dest");else if(e.src.startsWith("bq://"))e.config.dest="".concat(e.src,"_dest_").concat(t);else throw Error("Unsupported source:"+e.src)}else if(Array.isArray(e.src)||"string"!=typeof e.src&&e.src.inlinedRequests){let l="",i={},r=e6(this.apiClient,e);l=et("{model}:batchGenerateContent",r._url),i=r._query;let o=r.batch.inputConfig.requests,a=o.requests,s=[];for(let e of a){if(e.systemInstruction){let t=e.systemInstruction;delete e.systemInstruction;let n=e.request;n.systemInstruction=t,e.request=n}s.push(e)}return o.requests=s,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e4(e))}return await this.createInternal(e)},this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e9(z.PAGED_ITEM_BATCH_JOBS,e=>t.listInternal(e),await t.listInternal(e),e)}}}function te(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}function tt(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["data"]);null!=l&&en(t,["data"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["fileUri"]);null!=l&&en(t,["fileUri"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}function tn(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["model"]);null!=i&&en(t,["model"],i);let r=el(e,["createTime"]);null!=r&&en(t,["createTime"],r);let o=el(e,["updateTime"]);null!=o&&en(t,["updateTime"],o);let a=el(e,["expireTime"]);null!=a&&en(t,["expireTime"],a);let s=el(e,["usageMetadata"]);return null!=s&&en(t,["usageMetadata"],s),t}function tl(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["model"]);null!=i&&en(t,["model"],i);let r=el(e,["createTime"]);null!=r&&en(t,["createTime"],r);let o=el(e,["updateTime"]);null!=o&&en(t,["updateTime"],o);let a=el(e,["expireTime"]);null!=a&&en(t,["expireTime"],a);let s=el(e,["usageMetadata"]);return null!=s&&en(t,["usageMetadata"],s),t}class ti extends ee{async create(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["model"],eN(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["ttl"]);void 0!==t&&null!=n&&en(t,["ttl"],n);let l=el(e,["expireTime"]);void 0!==t&&null!=l&&en(t,["expireTime"],l);let i=el(e,["displayName"]);void 0!==t&&null!=i&&en(t,["displayName"],i);let r=el(e,["contents"]);if(void 0!==t&&null!=r){let e=eF(r);Array.isArray(e)&&(e=e.map(e=>tt(e))),en(t,["contents"],e)}let o=el(e,["systemInstruction"]);void 0!==t&&null!=o&&en(t,["systemInstruction"],tt(eG(o)));let a=el(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==el(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=el(e,["description"]);null!=n&&en(t,["description"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["parameters"]);null!=i&&en(t,["parameters"],i);let r=el(e,["parametersJsonSchema"]);null!=r&&en(t,["parametersJsonSchema"],r);let o=el(e,["response"]);null!=o&&en(t,["response"],o);let a=el(e,["responseJsonSchema"]);return null!=a&&en(t,["responseJsonSchema"],a),t})(e))),en(t,["functionDeclarations"],e)}let l=el(e,["retrieval"]);null!=l&&en(t,["retrieval"],l);let i=el(e,["googleSearch"]);null!=i&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n));let l=el(e,["excludeDomains"]);return null!=l&&en(t,["excludeDomains"],l),t}(i));let r=el(e,["googleSearchRetrieval"]);null!=r&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(r));let o=el(e,["enterpriseWebSearch"]);null!=o&&en(t,["enterpriseWebSearch"],function(e){let t={},n=el(e,["excludeDomains"]);return null!=n&&en(t,["excludeDomains"],n),t}(o));let a=el(e,["googleMaps"]);null!=a&&en(t,["googleMaps"],function(e){let t={},n=el(e,["authConfig"]);return null!=n&&en(t,["authConfig"],function(e){let t={},n=el(e,["apiKeyConfig"]);null!=n&&en(t,["apiKeyConfig"],function(e){let t={},n=el(e,["apiKeyString"]);return null!=n&&en(t,["apiKeyString"],n),t}(n));let l=el(e,["authType"]);null!=l&&en(t,["authType"],l);let i=el(e,["googleServiceAccountConfig"]);null!=i&&en(t,["googleServiceAccountConfig"],i);let r=el(e,["httpBasicAuthConfig"]);null!=r&&en(t,["httpBasicAuthConfig"],r);let o=el(e,["oauthConfig"]);null!=o&&en(t,["oauthConfig"],o);let a=el(e,["oidcConfig"]);return null!=a&&en(t,["oidcConfig"],a),t}(n)),t}(a)),null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let s=el(e,["computerUse"]);null!=s&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(s));let u=el(e,["codeExecution"]);return null!=u&&en(t,["codeExecution"],u),t})(e))),en(t,["tools"],e)}let s=el(e,["toolConfig"]);void 0!==t&&null!=s&&en(t,["toolConfig"],function(e){let t={},n=el(e,["functionCallingConfig"]);null!=n&&en(t,["functionCallingConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["allowedFunctionNames"]);return null!=l&&en(t,["allowedFunctionNames"],l),t}(n));let l=el(e,["retrievalConfig"]);return null!=l&&en(t,["retrievalConfig"],function(e){let t={},n=el(e,["latLng"]);null!=n&&en(t,["latLng"],function(e){let t={},n=el(e,["latitude"]);null!=n&&en(t,["latitude"],n);let l=el(e,["longitude"]);return null!=l&&en(t,["longitude"],l),t}(n));let l=el(e,["languageCode"]);return null!=l&&en(t,["languageCode"],l),t}(l)),t}(s));let u=el(e,["kmsKeyName"]);return void 0!==t&&null!=u&&en(t,["encryption_spec","kmsKeyName"],u),{}}(i,n)),n}(this.apiClient,e);return r=et("cachedContents",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>tl(e))}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["model"],eN(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["ttl"]);void 0!==t&&null!=n&&en(t,["ttl"],n);let l=el(e,["expireTime"]);void 0!==t&&null!=l&&en(t,["expireTime"],l);let i=el(e,["displayName"]);void 0!==t&&null!=i&&en(t,["displayName"],i);let r=el(e,["contents"]);if(void 0!==t&&null!=r){let e=eF(r);Array.isArray(e)&&(e=e.map(e=>te(e))),en(t,["contents"],e)}let o=el(e,["systemInstruction"]);void 0!==t&&null!=o&&en(t,["systemInstruction"],te(eG(o)));let a=el(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["behavior"]);null!=n&&en(t,["behavior"],n);let l=el(e,["description"]);null!=l&&en(t,["description"],l);let i=el(e,["name"]);null!=i&&en(t,["name"],i);let r=el(e,["parameters"]);null!=r&&en(t,["parameters"],r);let o=el(e,["parametersJsonSchema"]);null!=o&&en(t,["parametersJsonSchema"],o);let a=el(e,["response"]);null!=a&&en(t,["response"],a);let s=el(e,["responseJsonSchema"]);return null!=s&&en(t,["responseJsonSchema"],s),t})(e))),en(t,["functionDeclarations"],e)}if(void 0!==el(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let l=el(e,["googleSearch"]);null!=l&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);if(null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n)),void 0!==el(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(l));let i=el(e,["googleSearchRetrieval"]);if(null!=i&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(i)),void 0!==el(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==el(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let r=el(e,["computerUse"]);null!=r&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(r));let o=el(e,["codeExecution"]);return null!=o&&en(t,["codeExecution"],o),t})(e))),en(t,["tools"],e)}let s=el(e,["toolConfig"]);if(void 0!==t&&null!=s&&en(t,["toolConfig"],function(e){let t={},n=el(e,["functionCallingConfig"]);null!=n&&en(t,["functionCallingConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["allowedFunctionNames"]);return null!=l&&en(t,["allowedFunctionNames"],l),t}(n));let l=el(e,["retrievalConfig"]);return null!=l&&en(t,["retrievalConfig"],function(e){let t={},n=el(e,["latLng"]);null!=n&&en(t,["latLng"],function(e){let t={},n=el(e,["latitude"]);null!=n&&en(t,["latitude"],n);let l=el(e,["longitude"]);return null!=l&&en(t,["longitude"],l),t}(n));let l=el(e,["languageCode"]);return null!=l&&en(t,["languageCode"],l),t}(l)),t}(s)),void 0!==el(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.");return{}}(i,n)),n}(this.apiClient,e);return r=et("cachedContents",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tn(e))}}async get(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],eW(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>tl(e))}{let t=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],eW(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tn(e))}}async delete(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],eW(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);return null!=n&&en(t,["sdkHttpResponse"],n),t}(e),n=new eT;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],eW(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);return null!=n&&en(t,["sdkHttpResponse"],n),t}(e),n=new eT;return Object.assign(n,t),n})}}async update(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],eW(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["ttl"]);void 0!==t&&null!=n&&en(t,["ttl"],n);let l=el(e,["expireTime"]);return void 0!==t&&null!=l&&en(t,["expireTime"],l),{}}(i,n)),n}(this.apiClient,e);return r=et("{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>tl(e))}{let t=function(e,t){let n={},l=el(t,["name"]);null!=l&&en(n,["_url","name"],eW(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["ttl"]);void 0!==t&&null!=n&&en(t,["ttl"],n);let l=el(e,["expireTime"]);return void 0!==t&&null!=l&&en(t,["expireTime"],l),{}}(i,n)),n}(this.apiClient,e);return r=et("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tn(e))}}async listInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e){let t={},n=el(e,["config"]);return null!=n&&en(t,["config"],function(e,t){let n=el(e,["pageSize"]);void 0!==t&&null!=n&&en(t,["_query","pageSize"],n);let l=el(e,["pageToken"]);return void 0!==t&&null!=l&&en(t,["_query","pageToken"],l),{}}(n,t)),t}(e);return r=et("cachedContents",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>tl(e))),en(t,["cachedContents"],e)}return t}(e),n=new eE;return Object.assign(n,t),n})}{let t=function(e){let t={},n=el(e,["config"]);return null!=n&&en(t,["config"],function(e,t){let n=el(e,["pageSize"]);void 0!==t&&null!=n&&en(t,["_query","pageSize"],n);let l=el(e,["pageToken"]);return void 0!==t&&null!=l&&en(t,["_query","pageToken"],l),{}}(n,t)),t}(e);return r=et("cachedContents",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>tn(e))),en(t,["cachedContents"],e)}return t}(e),n=new eE;return Object.assign(n,t),n})}}constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e9(z.PAGED_ITEM_CACHED_CONTENTS,e=>t.listInternal(e),await t.listInternal(e),e)}}}function tr(e){return this instanceof tr?(this.v=e,this):new tr(e)}function to(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var l,i=n.apply(e,t||[]),r=[];return l=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),l[Symbol.asyncIterator]=function(){return this},l;function o(e,t){i[e]&&(l[e]=function(t){return new Promise(function(n,l){r.push([e,t,n,l])>1||a(e,t)})},t&&(l[e]=t(l[e])))}function a(e,t){try{var n;(n=i[e](t)).value instanceof tr?Promise.resolve(n.value.v).then(s,u):p(r[0][2],n)}catch(e){p(r[0][3],e)}}function s(e){a("next",e)}function u(e){a("throw",e)}function p(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function ta(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],l=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&l>=e.length&&(e=void 0),{value:e&&e[l++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},l("next"),l("throw"),l("return"),t[Symbol.asyncIterator]=function(){return this},t);function l(n){t[n]=e[n]&&function(t){return new Promise(function(l,i){var r,o,a;r=l,o=i,a=(t=e[n](t)).done,Promise.resolve(t.value).then(function(e){r({value:e,done:a})},o)})}}}function ts(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function tu(e){if(void 0===e||0===e.length)return[];let t=[],n=e.length,l=0;for(;l<n;)if("user"===e[l].role)t.push(e[l]),l++;else{let i=[],r=!0;for(;l<n&&"model"===e[l].role;)i.push(e[l]),r&&!ts(e[l])&&(r=!1),l++;r?t.push(...i):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class tp{create(e){return new tc(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}constructor(e,t){this.modelsModule=e,this.apiClient=t}}class tc{async sendMessage(e){var t;await this.sendPromise;let n=eG(e.message),l=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});return this.sendPromise=(async()=>{var e,t,i;let r=await l,o=null==(t=null==(e=r.candidates)?void 0:e[0])?void 0:t.content,a=r.automaticFunctionCallingHistory,s=this.getHistory(!0).length,u=[];null!=a&&(u=null!=(i=a.slice(s))?i:[]),this.recordHistory(n,o?[o]:[],u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),l}async sendMessageStream(e){var t;await this.sendPromise;let n=eG(e.message),l=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!=(t=e.config)?t:this.config});this.sendPromise=l.then(()=>void 0).catch(()=>void 0);let i=await l;return this.processStreamResponse(i,n)}getHistory(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return structuredClone(e?tu(this.history):this.history)}processStreamResponse(e,t){var n,l;return to(this,arguments,function*(){var i,r,o,a;let s=[];try{for(var u,p=!0,c=ta(e);!(i=(u=yield tr(c.next())).done);p=!0){if(a=u.value,p=!1,function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let n=null==(t=e.candidates[0])?void 0:t.content;return void 0!==n&&ts(n)}(a)){let e=null==(l=null==(n=a.candidates)?void 0:n[0])?void 0:l.content;void 0!==e&&s.push(e)}yield yield tr(a)}}catch(e){r={error:e}}finally{try{!p&&!i&&(o=c.return)&&(yield tr(o.call(c)))}finally{if(r)throw r.error}}this.recordHistory(t,s)})}recordHistory(e,t,n){let l=[];t.length>0&&t.every(e=>void 0!==e.role)?l=t:l.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...tu(n)):this.history.push(e),this.history.push(...l)}constructor(e,t,n,l={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=l,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error("Role must be user or model, but got ".concat(t.role,"."))}}(i)}}class td extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,td.prototype)}}function tf(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["mimeType"]);null!=i&&en(t,["mimeType"],i);let r=el(e,["sizeBytes"]);null!=r&&en(t,["sizeBytes"],r);let o=el(e,["createTime"]);null!=o&&en(t,["createTime"],o);let a=el(e,["expirationTime"]);null!=a&&en(t,["expirationTime"],a);let s=el(e,["updateTime"]);null!=s&&en(t,["updateTime"],s);let u=el(e,["sha256Hash"]);null!=u&&en(t,["sha256Hash"],u);let p=el(e,["uri"]);null!=p&&en(t,["uri"],p);let c=el(e,["downloadUri"]);null!=c&&en(t,["downloadUri"],c);let d=el(e,["state"]);null!=d&&en(t,["state"],d);let f=el(e,["source"]);null!=f&&en(t,["source"],f);let m=el(e,["videoMetadata"]);null!=m&&en(t,["videoMetadata"],m);let h=el(e,["error"]);return null!=h&&en(t,["error"],function(e){let t={},n=el(e,["details"]);null!=n&&en(t,["details"],n);let l=el(e,["message"]);null!=l&&en(t,["message"],l);let i=el(e,["code"]);return null!=i&&en(t,["code"],i),t}(h)),t}class tm extends ee{async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>tf(e))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r=function(e){let t={},n=el(e,["config"]);return null!=n&&en(t,["config"],function(e,t){let n=el(e,["pageSize"]);void 0!==t&&null!=n&&en(t,["_query","pageSize"],n);let l=el(e,["pageToken"]);return void 0!==t&&null!=l&&en(t,["_query","pageToken"],l),{}}(n,t)),t}(e);return l=et("files",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["files"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>tf(e))),en(t,["files"],e)}return t}(e),n=new eA;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r=function(e){let t={},n=el(e,["file"]);null!=n&&en(t,["file"],function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["mimeType"]);null!=i&&en(t,["mimeType"],i);let r=el(e,["sizeBytes"]);null!=r&&en(t,["sizeBytes"],r);let o=el(e,["createTime"]);null!=o&&en(t,["createTime"],o);let a=el(e,["expirationTime"]);null!=a&&en(t,["expirationTime"],a);let s=el(e,["updateTime"]);null!=s&&en(t,["updateTime"],s);let u=el(e,["sha256Hash"]);null!=u&&en(t,["sha256Hash"],u);let p=el(e,["uri"]);null!=p&&en(t,["uri"],p);let c=el(e,["downloadUri"]);null!=c&&en(t,["downloadUri"],c);let d=el(e,["state"]);null!=d&&en(t,["state"],d);let f=el(e,["source"]);null!=f&&en(t,["source"],f);let m=el(e,["videoMetadata"]);null!=m&&en(t,["videoMetadata"],m);let h=el(e,["error"]);return null!=h&&en(t,["error"],function(e){let t={},n=el(e,["details"]);null!=n&&en(t,["details"],n);let l=el(e,["message"]);null!=l&&en(t,["message"],l);let i=el(e,["code"]);return null!=i&&en(t,["code"],i),t}(h)),t}(n));let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);return l=et("upload/v1beta/files",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);return null!=n&&en(t,["sdkHttpResponse"],n),t}(e),n=new e_;return Object.assign(n,t),n})}}async get(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["_url","file"],ez(n));let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);return l=et("files/{file}",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>tf(e))}}async delete(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["_url","file"],ez(n));let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);return l=et("files/{file}",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);return null!=n&&en(t,["sdkHttpResponse"],n),t}(e),n=new eO;return Object.assign(n,t),n})}}constructor(e){var t;super(),t=this,this.apiClient=e,this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e9(z.PAGED_ITEM_FILES,e=>t.listInternal(e),await t.listInternal(e),e)}}}function th(e){let t={},n=el(e,["prebuiltVoiceConfig"]);return null!=n&&en(t,["prebuiltVoiceConfig"],function(e){let t={},n=el(e,["voiceName"]);return null!=n&&en(t,["voiceName"],n),t}(n)),t}function tg(e){let t={},n=el(e,["text"]);null!=n&&en(t,["text"],n);let l=el(e,["weight"]);return null!=l&&en(t,["weight"],l),t}function ty(e){let t={},n=el(e,["temperature"]);null!=n&&en(t,["temperature"],n);let l=el(e,["topK"]);null!=l&&en(t,["topK"],l);let i=el(e,["seed"]);null!=i&&en(t,["seed"],i);let r=el(e,["guidance"]);null!=r&&en(t,["guidance"],r);let o=el(e,["bpm"]);null!=o&&en(t,["bpm"],o);let a=el(e,["density"]);null!=a&&en(t,["density"],a);let s=el(e,["brightness"]);null!=s&&en(t,["brightness"],s);let u=el(e,["scale"]);null!=u&&en(t,["scale"],u);let p=el(e,["muteBass"]);null!=p&&en(t,["muteBass"],p);let c=el(e,["muteDrums"]);null!=c&&en(t,["muteDrums"],c);let d=el(e,["onlyBassAndDrums"]);null!=d&&en(t,["onlyBassAndDrums"],d);let f=el(e,["musicGenerationMode"]);return null!=f&&en(t,["musicGenerationMode"],f),t}function tC(e){let t={},n=el(e,["model"]);return null!=n&&en(t,["model"],n),t}function tv(e){let t={},n=el(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>tg(e))),en(t,["weightedPrompts"],e)}return t}function tT(e){let t={},n=el(e,["setup"]);null!=n&&en(t,["setup"],tC(n));let l=el(e,["clientContent"]);null!=l&&en(t,["clientContent"],tv(l));let i=el(e,["musicGenerationConfig"]);null!=i&&en(t,["musicGenerationConfig"],ty(i));let r=el(e,["playbackControl"]);return null!=r&&en(t,["playbackControl"],r),t}function tE(e){let t={},n=el(e,["text"]);null!=n&&en(t,["text"],n);let l=el(e,["finished"]);return null!=l&&en(t,["finished"],l),t}function tA(e){let t={},n=el(e,["modality"]);null!=n&&en(t,["modality"],n);let l=el(e,["tokenCount"]);return null!=l&&en(t,["tokenCount"],l),t}function t_(e){let t={},n=el(e,["text"]);null!=n&&en(t,["text"],n);let l=el(e,["finished"]);return null!=l&&en(t,["finished"],l),t}function tO(e){let t={},n=el(e,["modality"]);null!=n&&en(t,["modality"],n);let l=el(e,["tokenCount"]);return null!=l&&en(t,["tokenCount"],l),t}function tI(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}function tS(e){let t={},n=el(e,["prebuiltVoiceConfig"]);return null!=n&&en(t,["prebuiltVoiceConfig"],function(e){let t={},n=el(e,["voiceName"]);return null!=n&&en(t,["voiceName"],n),t}(n)),t}function tb(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["contents"]);if(null!=i){let e=eF(i);Array.isArray(e)&&(e=e.map(e=>tI(e))),en(n,["contents"],e)}let r=el(t,["config"]);return null!=r&&en(n,["generationConfig"],function(e,t,n){let l={},i=el(t,["systemInstruction"]);void 0!==n&&null!=i&&en(n,["systemInstruction"],tI(eG(i)));let r=el(t,["temperature"]);null!=r&&en(l,["temperature"],r);let o=el(t,["topP"]);null!=o&&en(l,["topP"],o);let a=el(t,["topK"]);null!=a&&en(l,["topK"],a);let s=el(t,["candidateCount"]);null!=s&&en(l,["candidateCount"],s);let u=el(t,["maxOutputTokens"]);null!=u&&en(l,["maxOutputTokens"],u);let p=el(t,["stopSequences"]);null!=p&&en(l,["stopSequences"],p);let c=el(t,["responseLogprobs"]);null!=c&&en(l,["responseLogprobs"],c);let d=el(t,["logprobs"]);null!=d&&en(l,["logprobs"],d);let f=el(t,["presencePenalty"]);null!=f&&en(l,["presencePenalty"],f);let m=el(t,["frequencyPenalty"]);null!=m&&en(l,["frequencyPenalty"],m);let h=el(t,["seed"]);null!=h&&en(l,["seed"],h);let g=el(t,["responseMimeType"]);null!=g&&en(l,["responseMimeType"],g);let y=el(t,["responseSchema"]);null!=y&&en(l,["responseSchema"],function(e){let t={},n=el(e,["anyOf"]);null!=n&&en(t,["anyOf"],n);let l=el(e,["default"]);null!=l&&en(t,["default"],l);let i=el(e,["description"]);null!=i&&en(t,["description"],i);let r=el(e,["enum"]);null!=r&&en(t,["enum"],r);let o=el(e,["example"]);null!=o&&en(t,["example"],o);let a=el(e,["format"]);null!=a&&en(t,["format"],a);let s=el(e,["items"]);null!=s&&en(t,["items"],s);let u=el(e,["maxItems"]);null!=u&&en(t,["maxItems"],u);let p=el(e,["maxLength"]);null!=p&&en(t,["maxLength"],p);let c=el(e,["maxProperties"]);null!=c&&en(t,["maxProperties"],c);let d=el(e,["maximum"]);null!=d&&en(t,["maximum"],d);let f=el(e,["minItems"]);null!=f&&en(t,["minItems"],f);let m=el(e,["minLength"]);null!=m&&en(t,["minLength"],m);let h=el(e,["minProperties"]);null!=h&&en(t,["minProperties"],h);let g=el(e,["minimum"]);null!=g&&en(t,["minimum"],g);let y=el(e,["nullable"]);null!=y&&en(t,["nullable"],y);let C=el(e,["pattern"]);null!=C&&en(t,["pattern"],C);let v=el(e,["properties"]);null!=v&&en(t,["properties"],v);let T=el(e,["propertyOrdering"]);null!=T&&en(t,["propertyOrdering"],T);let E=el(e,["required"]);null!=E&&en(t,["required"],E);let A=el(e,["title"]);null!=A&&en(t,["title"],A);let _=el(e,["type"]);return null!=_&&en(t,["type"],_),t}(ej(y)));let C=el(t,["responseJsonSchema"]);if(null!=C&&en(l,["responseJsonSchema"],C),void 0!==el(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==el(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let v=el(t,["safetySettings"]);if(void 0!==n&&null!=v){let e=v;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==el(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let n=el(e,["category"]);null!=n&&en(t,["category"],n);let l=el(e,["threshold"]);return null!=l&&en(t,["threshold"],l),t})(e))),en(n,["safetySettings"],e)}let T=el(t,["tools"]);if(void 0!==n&&null!=T){let e=eY(T);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["behavior"]);null!=n&&en(t,["behavior"],n);let l=el(e,["description"]);null!=l&&en(t,["description"],l);let i=el(e,["name"]);null!=i&&en(t,["name"],i);let r=el(e,["parameters"]);null!=r&&en(t,["parameters"],r);let o=el(e,["parametersJsonSchema"]);null!=o&&en(t,["parametersJsonSchema"],o);let a=el(e,["response"]);null!=a&&en(t,["response"],a);let s=el(e,["responseJsonSchema"]);return null!=s&&en(t,["responseJsonSchema"],s),t})(e))),en(t,["functionDeclarations"],e)}if(void 0!==el(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let l=el(e,["googleSearch"]);null!=l&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);if(null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n)),void 0!==el(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(l));let i=el(e,["googleSearchRetrieval"]);if(null!=i&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(i)),void 0!==el(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==el(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let r=el(e,["computerUse"]);null!=r&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(r));let o=el(e,["codeExecution"]);return null!=o&&en(t,["codeExecution"],o),t})(eB(e)))),en(n,["tools"],e)}let E=el(t,["toolConfig"]);if(void 0!==n&&null!=E&&en(n,["toolConfig"],function(e){let t={},n=el(e,["functionCallingConfig"]);null!=n&&en(t,["functionCallingConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["allowedFunctionNames"]);return null!=l&&en(t,["allowedFunctionNames"],l),t}(n));let l=el(e,["retrievalConfig"]);return null!=l&&en(t,["retrievalConfig"],function(e){let t={},n=el(e,["latLng"]);null!=n&&en(t,["latLng"],function(e){let t={},n=el(e,["latitude"]);null!=n&&en(t,["latitude"],n);let l=el(e,["longitude"]);return null!=l&&en(t,["longitude"],l),t}(n));let l=el(e,["languageCode"]);return null!=l&&en(t,["languageCode"],l),t}(l)),t}(E)),void 0!==el(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let A=el(t,["cachedContent"]);void 0!==n&&null!=A&&en(n,["cachedContent"],eW(e,A));let _=el(t,["responseModalities"]);null!=_&&en(l,["responseModalities"],_);let O=el(t,["mediaResolution"]);null!=O&&en(l,["mediaResolution"],O);let I=el(t,["speechConfig"]);if(null!=I&&en(l,["speechConfig"],function(e){let t={},n=el(e,["voiceConfig"]);null!=n&&en(t,["voiceConfig"],tS(n));let l=el(e,["multiSpeakerVoiceConfig"]);null!=l&&en(t,["multiSpeakerVoiceConfig"],function(e){let t={},n=el(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["speaker"]);null!=n&&en(t,["speaker"],n);let l=el(e,["voiceConfig"]);return null!=l&&en(t,["voiceConfig"],tS(l)),t})(e))),en(t,["speakerVoiceConfigs"],e)}return t}(l));let i=el(e,["languageCode"]);return null!=i&&en(t,["languageCode"],i),t}(eV(I))),void 0!==el(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let S=el(t,["thinkingConfig"]);return null!=S&&en(l,["thinkingConfig"],function(e){let t={},n=el(e,["includeThoughts"]);null!=n&&en(t,["includeThoughts"],n);let l=el(e,["thinkingBudget"]);return null!=l&&en(t,["thinkingBudget"],l),t}(S)),l}(e,r,n)),n}function tR(e){let t={};if(void 0!==el(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let n=el(e,["imageBytes"]);null!=n&&en(t,["bytesBase64Encoded"],ei(n));let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}function tN(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["data"]);null!=l&&en(t,["data"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["fileUri"]);null!=l&&en(t,["fileUri"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}function tP(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==el(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=el(e,["description"]);null!=n&&en(t,["description"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["parameters"]);null!=i&&en(t,["parameters"],i);let r=el(e,["parametersJsonSchema"]);null!=r&&en(t,["parametersJsonSchema"],r);let o=el(e,["response"]);null!=o&&en(t,["response"],o);let a=el(e,["responseJsonSchema"]);return null!=a&&en(t,["responseJsonSchema"],a),t})(e))),en(t,["functionDeclarations"],e)}let l=el(e,["retrieval"]);null!=l&&en(t,["retrieval"],l);let i=el(e,["googleSearch"]);null!=i&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n));let l=el(e,["excludeDomains"]);return null!=l&&en(t,["excludeDomains"],l),t}(i));let r=el(e,["googleSearchRetrieval"]);null!=r&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(r));let o=el(e,["enterpriseWebSearch"]);null!=o&&en(t,["enterpriseWebSearch"],function(e){let t={},n=el(e,["excludeDomains"]);return null!=n&&en(t,["excludeDomains"],n),t}(o));let a=el(e,["googleMaps"]);null!=a&&en(t,["googleMaps"],function(e){let t={},n=el(e,["authConfig"]);return null!=n&&en(t,["authConfig"],function(e){let t={},n=el(e,["apiKeyConfig"]);null!=n&&en(t,["apiKeyConfig"],function(e){let t={},n=el(e,["apiKeyString"]);return null!=n&&en(t,["apiKeyString"],n),t}(n));let l=el(e,["authType"]);null!=l&&en(t,["authType"],l);let i=el(e,["googleServiceAccountConfig"]);null!=i&&en(t,["googleServiceAccountConfig"],i);let r=el(e,["httpBasicAuthConfig"]);null!=r&&en(t,["httpBasicAuthConfig"],r);let o=el(e,["oauthConfig"]);null!=o&&en(t,["oauthConfig"],o);let a=el(e,["oidcConfig"]);return null!=a&&en(t,["oidcConfig"],a),t}(n)),t}(a)),null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let s=el(e,["computerUse"]);null!=s&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(s));let u=el(e,["codeExecution"]);return null!=u&&en(t,["codeExecution"],u),t}function tM(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["contents"]);if(null!=i){let e=eF(i);Array.isArray(e)&&(e=e.map(e=>tN(e))),en(n,["contents"],e)}let r=el(t,["config"]);return null!=r&&en(n,["generationConfig"],function(e,t,n){let l={},i=el(t,["systemInstruction"]);void 0!==n&&null!=i&&en(n,["systemInstruction"],tN(eG(i)));let r=el(t,["temperature"]);null!=r&&en(l,["temperature"],r);let o=el(t,["topP"]);null!=o&&en(l,["topP"],o);let a=el(t,["topK"]);null!=a&&en(l,["topK"],a);let s=el(t,["candidateCount"]);null!=s&&en(l,["candidateCount"],s);let u=el(t,["maxOutputTokens"]);null!=u&&en(l,["maxOutputTokens"],u);let p=el(t,["stopSequences"]);null!=p&&en(l,["stopSequences"],p);let c=el(t,["responseLogprobs"]);null!=c&&en(l,["responseLogprobs"],c);let d=el(t,["logprobs"]);null!=d&&en(l,["logprobs"],d);let f=el(t,["presencePenalty"]);null!=f&&en(l,["presencePenalty"],f);let m=el(t,["frequencyPenalty"]);null!=m&&en(l,["frequencyPenalty"],m);let h=el(t,["seed"]);null!=h&&en(l,["seed"],h);let g=el(t,["responseMimeType"]);null!=g&&en(l,["responseMimeType"],g);let y=el(t,["responseSchema"]);null!=y&&en(l,["responseSchema"],function(e){let t={},n=el(e,["anyOf"]);null!=n&&en(t,["anyOf"],n);let l=el(e,["default"]);null!=l&&en(t,["default"],l);let i=el(e,["description"]);null!=i&&en(t,["description"],i);let r=el(e,["enum"]);null!=r&&en(t,["enum"],r);let o=el(e,["example"]);null!=o&&en(t,["example"],o);let a=el(e,["format"]);null!=a&&en(t,["format"],a);let s=el(e,["items"]);null!=s&&en(t,["items"],s);let u=el(e,["maxItems"]);null!=u&&en(t,["maxItems"],u);let p=el(e,["maxLength"]);null!=p&&en(t,["maxLength"],p);let c=el(e,["maxProperties"]);null!=c&&en(t,["maxProperties"],c);let d=el(e,["maximum"]);null!=d&&en(t,["maximum"],d);let f=el(e,["minItems"]);null!=f&&en(t,["minItems"],f);let m=el(e,["minLength"]);null!=m&&en(t,["minLength"],m);let h=el(e,["minProperties"]);null!=h&&en(t,["minProperties"],h);let g=el(e,["minimum"]);null!=g&&en(t,["minimum"],g);let y=el(e,["nullable"]);null!=y&&en(t,["nullable"],y);let C=el(e,["pattern"]);null!=C&&en(t,["pattern"],C);let v=el(e,["properties"]);null!=v&&en(t,["properties"],v);let T=el(e,["propertyOrdering"]);null!=T&&en(t,["propertyOrdering"],T);let E=el(e,["required"]);null!=E&&en(t,["required"],E);let A=el(e,["title"]);null!=A&&en(t,["title"],A);let _=el(e,["type"]);return null!=_&&en(t,["type"],_),t}(ej(y)));let C=el(t,["responseJsonSchema"]);null!=C&&en(l,["responseJsonSchema"],C);let v=el(t,["routingConfig"]);null!=v&&en(l,["routingConfig"],v);let T=el(t,["modelSelectionConfig"]);null!=T&&en(l,["modelConfig"],function(e){let t={},n=el(e,["featureSelectionPreference"]);return null!=n&&en(t,["featureSelectionPreference"],n),t}(T));let E=el(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["method"]);null!=n&&en(t,["method"],n);let l=el(e,["category"]);null!=l&&en(t,["category"],l);let i=el(e,["threshold"]);return null!=i&&en(t,["threshold"],i),t})(e))),en(n,["safetySettings"],e)}let A=el(t,["tools"]);if(void 0!==n&&null!=A){let e=eY(A);Array.isArray(e)&&(e=e.map(e=>tP(eB(e)))),en(n,["tools"],e)}let _=el(t,["toolConfig"]);void 0!==n&&null!=_&&en(n,["toolConfig"],function(e){let t={},n=el(e,["functionCallingConfig"]);null!=n&&en(t,["functionCallingConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["allowedFunctionNames"]);return null!=l&&en(t,["allowedFunctionNames"],l),t}(n));let l=el(e,["retrievalConfig"]);return null!=l&&en(t,["retrievalConfig"],function(e){let t={},n=el(e,["latLng"]);null!=n&&en(t,["latLng"],function(e){let t={},n=el(e,["latitude"]);null!=n&&en(t,["latitude"],n);let l=el(e,["longitude"]);return null!=l&&en(t,["longitude"],l),t}(n));let l=el(e,["languageCode"]);return null!=l&&en(t,["languageCode"],l),t}(l)),t}(_));let O=el(t,["labels"]);void 0!==n&&null!=O&&en(n,["labels"],O);let I=el(t,["cachedContent"]);void 0!==n&&null!=I&&en(n,["cachedContent"],eW(e,I));let S=el(t,["responseModalities"]);null!=S&&en(l,["responseModalities"],S);let b=el(t,["mediaResolution"]);null!=b&&en(l,["mediaResolution"],b);let R=el(t,["speechConfig"]);null!=R&&en(l,["speechConfig"],function(e){let t={},n=el(e,["voiceConfig"]);if(null!=n&&en(t,["voiceConfig"],function(e){let t={},n=el(e,["prebuiltVoiceConfig"]);return null!=n&&en(t,["prebuiltVoiceConfig"],function(e){let t={},n=el(e,["voiceName"]);return null!=n&&en(t,["voiceName"],n),t}(n)),t}(n)),void 0!==el(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let l=el(e,["languageCode"]);return null!=l&&en(t,["languageCode"],l),t}(eV(R)));let N=el(t,["audioTimestamp"]);null!=N&&en(l,["audioTimestamp"],N);let P=el(t,["thinkingConfig"]);return null!=P&&en(l,["thinkingConfig"],function(e){let t={},n=el(e,["includeThoughts"]);null!=n&&en(t,["includeThoughts"],n);let l=el(e,["thinkingBudget"]);return null!=l&&en(t,["thinkingBudget"],l),t}(P)),l}(e,r,n)),n}function tD(e){let t={},n=el(e,["gcsUri"]);null!=n&&en(t,["gcsUri"],n);let l=el(e,["imageBytes"]);null!=l&&en(t,["bytesBase64Encoded"],ei(l));let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}function tx(e){let t={},n=el(e,["uri"]);null!=n&&en(t,["gcsUri"],n);let l=el(e,["videoBytes"]);null!=l&&en(t,["bytesBase64Encoded"],ei(l));let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}function tw(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["candidates"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["content"]);null!=n&&en(t,["content"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(n));let l=el(e,["citationMetadata"]);null!=l&&en(t,["citationMetadata"],function(e){let t={},n=el(e,["citationSources"]);return null!=n&&en(t,["citations"],n),t}(l));let i=el(e,["tokenCount"]);null!=i&&en(t,["tokenCount"],i);let r=el(e,["finishReason"]);null!=r&&en(t,["finishReason"],r);let o=el(e,["urlContextMetadata"]);null!=o&&en(t,["urlContextMetadata"],function(e){let t={},n=el(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["retrievedUrl"]);null!=n&&en(t,["retrievedUrl"],n);let l=el(e,["urlRetrievalStatus"]);return null!=l&&en(t,["urlRetrievalStatus"],l),t})(e))),en(t,["urlMetadata"],e)}return t}(o));let a=el(e,["avgLogprobs"]);null!=a&&en(t,["avgLogprobs"],a);let s=el(e,["groundingMetadata"]);null!=s&&en(t,["groundingMetadata"],s);let u=el(e,["index"]);null!=u&&en(t,["index"],u);let p=el(e,["logprobsResult"]);null!=p&&en(t,["logprobsResult"],p);let c=el(e,["safetyRatings"]);return null!=c&&en(t,["safetyRatings"],c),t})(e))),en(t,["candidates"],e)}let i=el(e,["modelVersion"]);null!=i&&en(t,["modelVersion"],i);let r=el(e,["promptFeedback"]);null!=r&&en(t,["promptFeedback"],r);let o=el(e,["responseId"]);null!=o&&en(t,["responseId"],o);let a=el(e,["usageMetadata"]);return null!=a&&en(t,["usageMetadata"],a),t}function tU(e){let t={},n=el(e,["safetyAttributes","categories"]);null!=n&&en(t,["categories"],n);let l=el(e,["safetyAttributes","scores"]);null!=l&&en(t,["scores"],l);let i=el(e,["contentType"]);return null!=i&&en(t,["contentType"],i),t}function tk(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["description"]);null!=i&&en(t,["description"],i);let r=el(e,["version"]);null!=r&&en(t,["version"],r);let o=el(e,["_self"]);null!=o&&en(t,["tunedModelInfo"],function(e){let t={},n=el(e,["baseModel"]);null!=n&&en(t,["baseModel"],n);let l=el(e,["createTime"]);null!=l&&en(t,["createTime"],l);let i=el(e,["updateTime"]);return null!=i&&en(t,["updateTime"],i),t}(o));let a=el(e,["inputTokenLimit"]);null!=a&&en(t,["inputTokenLimit"],a);let s=el(e,["outputTokenLimit"]);null!=s&&en(t,["outputTokenLimit"],s);let u=el(e,["supportedGenerationMethods"]);return null!=u&&en(t,["supportedActions"],u),t}function tq(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["candidates"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["content"]);null!=n&&en(t,["content"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["data"]);null!=l&&en(t,["data"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["fileUri"]);null!=l&&en(t,["fileUri"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(n));let l=el(e,["citationMetadata"]);null!=l&&en(t,["citationMetadata"],function(e){let t={},n=el(e,["citations"]);return null!=n&&en(t,["citations"],n),t}(l));let i=el(e,["finishMessage"]);null!=i&&en(t,["finishMessage"],i);let r=el(e,["finishReason"]);null!=r&&en(t,["finishReason"],r);let o=el(e,["urlContextMetadata"]);null!=o&&en(t,["urlContextMetadata"],function(e){let t={},n=el(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["retrievedUrl"]);null!=n&&en(t,["retrievedUrl"],n);let l=el(e,["urlRetrievalStatus"]);return null!=l&&en(t,["urlRetrievalStatus"],l),t})(e))),en(t,["urlMetadata"],e)}return t}(o));let a=el(e,["avgLogprobs"]);null!=a&&en(t,["avgLogprobs"],a);let s=el(e,["groundingMetadata"]);null!=s&&en(t,["groundingMetadata"],s);let u=el(e,["index"]);null!=u&&en(t,["index"],u);let p=el(e,["logprobsResult"]);null!=p&&en(t,["logprobsResult"],p);let c=el(e,["safetyRatings"]);return null!=c&&en(t,["safetyRatings"],c),t})(e))),en(t,["candidates"],e)}let i=el(e,["createTime"]);null!=i&&en(t,["createTime"],i);let r=el(e,["modelVersion"]);null!=r&&en(t,["modelVersion"],r);let o=el(e,["promptFeedback"]);null!=o&&en(t,["promptFeedback"],o);let a=el(e,["responseId"]);null!=a&&en(t,["responseId"],a);let s=el(e,["usageMetadata"]);return null!=s&&en(t,["usageMetadata"],s),t}function tL(e){let t={},n=el(e,["gcsUri"]);null!=n&&en(t,["gcsUri"],n);let l=el(e,["bytesBase64Encoded"]);null!=l&&en(t,["imageBytes"],ei(l));let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}function tG(e){let t={},n=el(e,["safetyAttributes","categories"]);null!=n&&en(t,["categories"],n);let l=el(e,["safetyAttributes","scores"]);null!=l&&en(t,["scores"],l);let i=el(e,["contentType"]);return null!=i&&en(t,["contentType"],i),t}function tH(e){let t={},n=el(e,["_self"]);null!=n&&en(t,["image"],tL(n));let l=el(e,["raiFilteredReason"]);null!=l&&en(t,["raiFilteredReason"],l);let i=el(e,["_self"]);null!=i&&en(t,["safetyAttributes"],tG(i));let r=el(e,["prompt"]);return null!=r&&en(t,["enhancedPrompt"],r),t}function tF(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["displayName"]);null!=l&&en(t,["displayName"],l);let i=el(e,["description"]);null!=i&&en(t,["description"],i);let r=el(e,["versionId"]);null!=r&&en(t,["version"],r);let o=el(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["endpoint"]);null!=n&&en(t,["name"],n);let l=el(e,["deployedModelId"]);return null!=l&&en(t,["deployedModelId"],l),t})(e))),en(t,["endpoints"],e)}let a=el(e,["labels"]);null!=a&&en(t,["labels"],a);let s=el(e,["_self"]);null!=s&&en(t,["tunedModelInfo"],function(e){let t={},n=el(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&en(t,["baseModel"],n);let l=el(e,["createTime"]);null!=l&&en(t,["createTime"],l);let i=el(e,["updateTime"]);return null!=i&&en(t,["updateTime"],i),t}(s));let u=el(e,["defaultCheckpointId"]);null!=u&&en(t,["defaultCheckpointId"],u);let p=el(e,["checkpoints"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["checkpointId"]);null!=n&&en(t,["checkpointId"],n);let l=el(e,["epoch"]);null!=l&&en(t,["epoch"],l);let i=el(e,["step"]);return null!=i&&en(t,["step"],i),t})(e))),en(t,["checkpoints"],e)}return t}let tj="x-goog-api-client",tV="google-genai-sdk/".concat("1.16.0"),tJ=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class tB{baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?"https://".concat(this.clientOptions.location,"-aiplatform.googleapis.com/"):"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!=(e=this.clientOptions.vertexai)&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return"projects/".concat(this.clientOptions.project,"/locations/").concat(this.clientOptions.location)}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,n){let l=[this.getRequestUrlInternal(t)];return n&&l.push(this.getBaseResourcePath()),""!==e&&l.push(e),new URL("".concat(l.join("/")))}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),l=this.constructUrl(e.path,t,n);if(e.queryParams)for(let[t,n]of Object.entries(e.queryParams))l.searchParams.append(t,String(n));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.unaryApiCall(l,i,e.httpMethod)}patchHttpOptions(e,t){let n=JSON.parse(JSON.stringify(e));for(let[e,l]of Object.entries(t))"object"==typeof l?n[e]=Object.assign(Object.assign({},n[e]),l):void 0!==l&&(n[e]=l);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),l=this.constructUrl(e.path,t,n);l.searchParams.has("alt")&&"sse"===l.searchParams.get("alt")||l.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.streamApiCall(l,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){let l=new AbortController,i=l.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>l.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}n&&n.addEventListener("abort",()=>{l.abort()}),e.signal=i}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let n={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");n=t}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}e.body=JSON.stringify(function e(t,n){let l=Object.assign({},t);for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let i=n[t],r=l[t];i&&"object"==typeof i&&!Array.isArray(i)&&r&&"object"==typeof r&&!Array.isArray(r)?l[t]=e(r,i):(r&&i&&typeof r!=typeof i&&console.warn('includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "'.concat(t,'". Original type: ').concat(typeof r,", New type: ").concat(typeof i,". Overwriting.")),l[t]=i)}return l}(n,t))}(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await tY(e),new er(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await tY(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){var t;return to(this,arguments,function*(){let n=null==(t=null==e?void 0:e.body)?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!n)throw Error("Response body is empty");try{let t="";for(;;){let{done:i,value:r}=yield tr(n.read());if(i){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let o=l.decode(r,{stream:!0});try{let e=JSON.parse(o);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),n=t.status,l=t.code,i="got status: ".concat(n,". ").concat(JSON.stringify(e));if(l>=400&&l<600)throw new td({message:i,status:l})}}catch(e){if("ApiError"===e.name)throw e}let a=(t+=o).match(tJ);for(;a;){let n=a[1];try{let l=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield tr(new er(l)),a=(t=t.slice(a[0].length)).match(tJ)}catch(e){throw Error("exception parsing stream chunk ".concat(n,". ").concat(e))}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error("exception ".concat(e," sending request"))})}getDefaultHeaders(){let e={},t=tV+" "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[tj]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e){let t=new Headers;if(e&&e.headers){for(let[n,l]of Object.entries(e.headers))t.append(n,l);e.timeout&&e.timeout>0&&t.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;let l={};null!=t&&(l.mimeType=t.mimeType,l.name=t.name,l.displayName=t.displayName),l.name&&!l.name.startsWith("files/")&&(l.name="files/".concat(l.name));let i=this.clientOptions.uploader,r=await i.stat(e);l.sizeBytes=String(r.size);let o=null!=(n=null==t?void 0:t.mimeType)?n:r.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");l.mimeType=o;let a=await this.fetchUploadUrl(l,t);return i.upload(e,a,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t){var n;let l={};l=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(e.sizeBytes),"X-Goog-Upload-Header-Content-Type":"".concat(e.mimeType)}};let i={file:e},r=await this.request({path:et("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:l});if(!r||!(null==r?void 0:r.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let o=null==(n=null==r?void 0:r.headers)?void 0:n["x-goog-upload-url"];if(void 0===o)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return o}constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let l={};this.clientOptions.vertexai?(l.apiVersion=null!=(t=this.clientOptions.apiVersion)?t:"v1beta1",l.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(l.apiVersion=null!=(n=this.clientOptions.apiVersion)?n:"v1beta",l.baseUrl="https://generativelanguage.googleapis.com/"),l.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=l,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(l,e.httpOptions))}}async function tY(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let n=e.status,l=JSON.stringify((null==(t=e.headers.get("content-type"))?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(n>=400&&n<600)throw new td({message:l,status:n});throw Error(l)}}function tW(e){for(let n of e){var t;if(null!==(t=n)&&"object"==typeof t&&t instanceof tz||"object"==typeof n&&"inputSchema"in n)return!0}return!1}function tK(e){var t;let n=null!=(t=e[tj])?t:"";e[tj]=(n+" ".concat("mcp_used/unknown")).trimStart()}class tz{static create(e,t){return new tz(e,t)}async initialize(){var e,t,n,l;if(this.mcpTools.length>0)return;let i={},r=[];for(let u of this.mcpClients)try{for(var o,a=!0,s=(t=void 0,ta(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return to(this,arguments,function*(){let n,l=0;for(;l<t;){let t=yield tr(e.listTools({cursor:n}));for(let e of t.tools)yield yield tr(e),l++;if(!t.nextCursor)break;n=t.nextCursor}})}(u)));!(e=(o=await s.next()).done);a=!0){l=o.value,a=!1,r.push(l);let e=l.name;if(i[e])throw Error("Duplicate function name ".concat(e," found in MCP tools. Please ensure function names are unique."));i[e]=u}}catch(e){t={error:e}}finally{try{!a&&!e&&(n=s.return)&&await n.call(s)}finally{if(t)throw t.error}}this.mcpTools=r,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],l=new Set;for(let i of e){let e=i.name;if(l.has(e))throw Error("Duplicate function name ".concat(e," found in MCP tools. Please ensure function names are unique."));l.add(e);let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(n.responseJsonSchema=e.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}(i,t);r.functionDeclarations&&n.push(...r.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let n of e)if(n.name in this.functionNameToMcpClient){let e,l=this.functionNameToMcpClient[n.name];this.config.timeout&&(e={timeout:this.config.timeout});let i=await l.callTool({name:n.name,arguments:n.args},void 0,e);t.push({functionResponse:{name:n.name,response:i.isError?{error:i}:i}})}return t}constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}}async function tX(e,t,n){let l=new eb;Object.assign(l,function(e){let t={};null!=el(e,["setupComplete"])&&en(t,["setupComplete"],{});let n=el(e,["serverContent"]);null!=n&&en(t,["serverContent"],function(e){let t={},n=el(e,["audioChunks"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);null!=l&&en(t,["mimeType"],l);let i=el(e,["sourceMetadata"]);return null!=i&&en(t,["sourceMetadata"],function(e){let t={},n=el(e,["clientContent"]);null!=n&&en(t,["clientContent"],function(e){let t={},n=el(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["text"]);null!=n&&en(t,["text"],n);let l=el(e,["weight"]);return null!=l&&en(t,["weight"],l),t})(e))),en(t,["weightedPrompts"],e)}return t}(n));let l=el(e,["musicGenerationConfig"]);return null!=l&&en(t,["musicGenerationConfig"],function(e){let t={},n=el(e,["temperature"]);null!=n&&en(t,["temperature"],n);let l=el(e,["topK"]);null!=l&&en(t,["topK"],l);let i=el(e,["seed"]);null!=i&&en(t,["seed"],i);let r=el(e,["guidance"]);null!=r&&en(t,["guidance"],r);let o=el(e,["bpm"]);null!=o&&en(t,["bpm"],o);let a=el(e,["density"]);null!=a&&en(t,["density"],a);let s=el(e,["brightness"]);null!=s&&en(t,["brightness"],s);let u=el(e,["scale"]);null!=u&&en(t,["scale"],u);let p=el(e,["muteBass"]);null!=p&&en(t,["muteBass"],p);let c=el(e,["muteDrums"]);null!=c&&en(t,["muteDrums"],c);let d=el(e,["onlyBassAndDrums"]);null!=d&&en(t,["onlyBassAndDrums"],d);let f=el(e,["musicGenerationMode"]);return null!=f&&en(t,["musicGenerationMode"],f),t}(l)),t}(i)),t})(e))),en(t,["audioChunks"],e)}return t}(n));let l=el(e,["filteredPrompt"]);return null!=l&&en(t,["filteredPrompt"],function(e){let t={},n=el(e,["text"]);null!=n&&en(t,["text"],n);let l=el(e,["filteredReason"]);return null!=l&&en(t,["filteredReason"],l),t}(l)),t}(n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data))),t(l)}class tQ{async connect(e){var t,n;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let l=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),r=function(e){let t=new Headers;for(let[n,l]of Object.entries(e))t.append(n,l);return t}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),a="".concat(l,"/ws/google.ai.generativelanguage.").concat(i,".GenerativeService.BidiGenerateMusic?key=").concat(o),s=()=>{},u=new Promise(e=>{s=e}),p=e.callbacks,c=this.apiClient,d={onopen:function(){s({})},onmessage:e=>{tX(c,p.onmessage,e)},onerror:null!=(t=null==p?void 0:p.onerror)?t:function(e){},onclose:null!=(n=null==p?void 0:p.onclose)?n:function(e){}},f=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,n)=>{t[n]=e}),t}(r),d);f.connect(),await u;let m=tT({setup:tC({model:eR(this.apiClient,e.model)})});return f.send(JSON.stringify(m)),new tZ(f,this.apiClient)}constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}}class tZ{async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=tv(function(e){let t={},n=el(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>tg(e))),en(t,["weightedPrompts"],e)}return t}(e));this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=tT(function(e){let t={},n=el(e,["musicGenerationConfig"]);return null!=n&&en(t,["musicGenerationConfig"],ty(n)),t}(e));this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){let t=tT({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(K.PLAY)}pause(){this.sendPlaybackControl(K.PAUSE)}stop(){this.sendPlaybackControl(K.STOP)}resetContext(){this.sendPlaybackControl(K.RESET_CONTEXT)}close(){this.conn.close()}constructor(e,t){this.conn=e,this.apiClient=t}}async function t$(e,t,n){let l=new eS,i=JSON.parse(n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?new TextDecoder().decode(n.data):n.data);e.isVertexAI()?Object.assign(l,function(e){let t={},n=el(e,["setupComplete"]);null!=n&&en(t,["setupComplete"],function(e){let t={},n=el(e,["sessionId"]);return null!=n&&en(t,["sessionId"],n),t}(n));let l=el(e,["serverContent"]);null!=l&&en(t,["serverContent"],function(e){let t={},n=el(e,["modelTurn"]);null!=n&&en(t,["modelTurn"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["data"]);null!=l&&en(t,["data"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["fileUri"]);null!=l&&en(t,["fileUri"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(n));let l=el(e,["turnComplete"]);null!=l&&en(t,["turnComplete"],l);let i=el(e,["interrupted"]);null!=i&&en(t,["interrupted"],i);let r=el(e,["groundingMetadata"]);null!=r&&en(t,["groundingMetadata"],r);let o=el(e,["generationComplete"]);null!=o&&en(t,["generationComplete"],o);let a=el(e,["inputTranscription"]);null!=a&&en(t,["inputTranscription"],t_(a));let s=el(e,["outputTranscription"]);return null!=s&&en(t,["outputTranscription"],t_(s)),t}(l));let i=el(e,["toolCall"]);null!=i&&en(t,["toolCall"],function(e){let t={},n=el(e,["functionCalls"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["args"]);null!=n&&en(t,["args"],n);let l=el(e,["name"]);return null!=l&&en(t,["name"],l),t})(e))),en(t,["functionCalls"],e)}return t}(i));let r=el(e,["toolCallCancellation"]);null!=r&&en(t,["toolCallCancellation"],function(e){let t={},n=el(e,["ids"]);return null!=n&&en(t,["ids"],n),t}(r));let o=el(e,["usageMetadata"]);null!=o&&en(t,["usageMetadata"],function(e){let t={},n=el(e,["promptTokenCount"]);null!=n&&en(t,["promptTokenCount"],n);let l=el(e,["cachedContentTokenCount"]);null!=l&&en(t,["cachedContentTokenCount"],l);let i=el(e,["candidatesTokenCount"]);null!=i&&en(t,["responseTokenCount"],i);let r=el(e,["toolUsePromptTokenCount"]);null!=r&&en(t,["toolUsePromptTokenCount"],r);let o=el(e,["thoughtsTokenCount"]);null!=o&&en(t,["thoughtsTokenCount"],o);let a=el(e,["totalTokenCount"]);null!=a&&en(t,["totalTokenCount"],a);let s=el(e,["promptTokensDetails"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>tO(e))),en(t,["promptTokensDetails"],e)}let u=el(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>tO(e))),en(t,["cacheTokensDetails"],e)}let p=el(e,["candidatesTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>tO(e))),en(t,["responseTokensDetails"],e)}let c=el(e,["toolUsePromptTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>tO(e))),en(t,["toolUsePromptTokensDetails"],e)}let d=el(e,["trafficType"]);return null!=d&&en(t,["trafficType"],d),t}(o));let a=el(e,["goAway"]);null!=a&&en(t,["goAway"],function(e){let t={},n=el(e,["timeLeft"]);return null!=n&&en(t,["timeLeft"],n),t}(a));let s=el(e,["sessionResumptionUpdate"]);return null!=s&&en(t,["sessionResumptionUpdate"],function(e){let t={},n=el(e,["newHandle"]);null!=n&&en(t,["newHandle"],n);let l=el(e,["resumable"]);null!=l&&en(t,["resumable"],l);let i=el(e,["lastConsumedClientMessageIndex"]);return null!=i&&en(t,["lastConsumedClientMessageIndex"],i),t}(s)),t}(i)):Object.assign(l,function(e){let t={};null!=el(e,["setupComplete"])&&en(t,["setupComplete"],{});let n=el(e,["serverContent"]);null!=n&&en(t,["serverContent"],function(e){let t={},n=el(e,["modelTurn"]);null!=n&&en(t,["modelTurn"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(n));let l=el(e,["turnComplete"]);null!=l&&en(t,["turnComplete"],l);let i=el(e,["interrupted"]);null!=i&&en(t,["interrupted"],i);let r=el(e,["groundingMetadata"]);null!=r&&en(t,["groundingMetadata"],r);let o=el(e,["generationComplete"]);null!=o&&en(t,["generationComplete"],o);let a=el(e,["inputTranscription"]);null!=a&&en(t,["inputTranscription"],tE(a));let s=el(e,["outputTranscription"]);null!=s&&en(t,["outputTranscription"],tE(s));let u=el(e,["urlContextMetadata"]);return null!=u&&en(t,["urlContextMetadata"],function(e){let t={},n=el(e,["urlMetadata"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["retrievedUrl"]);null!=n&&en(t,["retrievedUrl"],n);let l=el(e,["urlRetrievalStatus"]);return null!=l&&en(t,["urlRetrievalStatus"],l),t})(e))),en(t,["urlMetadata"],e)}return t}(u)),t}(n));let l=el(e,["toolCall"]);null!=l&&en(t,["toolCall"],function(e){let t={},n=el(e,["functionCalls"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["id"]);null!=n&&en(t,["id"],n);let l=el(e,["args"]);null!=l&&en(t,["args"],l);let i=el(e,["name"]);return null!=i&&en(t,["name"],i),t})(e))),en(t,["functionCalls"],e)}return t}(l));let i=el(e,["toolCallCancellation"]);null!=i&&en(t,["toolCallCancellation"],function(e){let t={},n=el(e,["ids"]);return null!=n&&en(t,["ids"],n),t}(i));let r=el(e,["usageMetadata"]);null!=r&&en(t,["usageMetadata"],function(e){let t={},n=el(e,["promptTokenCount"]);null!=n&&en(t,["promptTokenCount"],n);let l=el(e,["cachedContentTokenCount"]);null!=l&&en(t,["cachedContentTokenCount"],l);let i=el(e,["responseTokenCount"]);null!=i&&en(t,["responseTokenCount"],i);let r=el(e,["toolUsePromptTokenCount"]);null!=r&&en(t,["toolUsePromptTokenCount"],r);let o=el(e,["thoughtsTokenCount"]);null!=o&&en(t,["thoughtsTokenCount"],o);let a=el(e,["totalTokenCount"]);null!=a&&en(t,["totalTokenCount"],a);let s=el(e,["promptTokensDetails"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>tA(e))),en(t,["promptTokensDetails"],e)}let u=el(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>tA(e))),en(t,["cacheTokensDetails"],e)}let p=el(e,["responseTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>tA(e))),en(t,["responseTokensDetails"],e)}let c=el(e,["toolUsePromptTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>tA(e))),en(t,["toolUsePromptTokensDetails"],e)}return t}(r));let o=el(e,["goAway"]);null!=o&&en(t,["goAway"],function(e){let t={},n=el(e,["timeLeft"]);return null!=n&&en(t,["timeLeft"],n),t}(o));let a=el(e,["sessionResumptionUpdate"]);return null!=a&&en(t,["sessionResumptionUpdate"],function(e){let t={},n=el(e,["newHandle"]);null!=n&&en(t,["newHandle"],n);let l=el(e,["resumable"]);null!=l&&en(t,["resumable"],l);let i=el(e,["lastConsumedClientMessageIndex"]);return null!=i&&en(t,["lastConsumedClientMessageIndex"],i),t}(a)),t}(i)),t(l)}class t0{async connect(e){var t,n,l,i,r,o;let a;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let s=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),p=this.apiClient.getHeaders();e.config&&e.config.tools&&tW(e.config.tools)&&tK(p);let c=function(e){let t=new Headers;for(let[n,l]of Object.entries(e))t.append(n,l);return t}(p);if(this.apiClient.isVertexAI())a="".concat(s,"/ws/google.cloud.aiplatform.").concat(u,".LlmBidiService/BidiGenerateContent"),await this.auth.addAuthHeaders(c);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==u&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),a="".concat(s,"/ws/google.ai.generativelanguage.").concat(u,".GenerativeService.").concat(t,"?").concat(n,"=").concat(e)}let d=()=>{},f=new Promise(e=>{d=e}),m=e.callbacks,h=this.apiClient,g={onopen:function(){var e;null==(e=null==m?void 0:m.onopen)||e.call(m),d({})},onmessage:e=>{t$(h,m.onmessage,e)},onerror:null!=(t=null==m?void 0:m.onerror)?t:function(e){},onclose:null!=(n=null==m?void 0:m.onclose)?n:function(e){}},y=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,n)=>{t[n]=e}),t}(c),g);y.connect(),await f;let v=eR(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();v="projects/".concat(e,"/locations/").concat(t,"/")+v}let T={};this.apiClient.isVertexAI()&&(null==(l=e.config)?void 0:l.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[C.AUDIO]}:e.config.responseModalities=[C.AUDIO]),(null==(i=e.config)?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let E=null!=(o=null==(r=e.config)?void 0:r.tools)?o:[],A=[];for(let e of E)this.isCallableTool(e)?A.push(await e.tool()):A.push(e);A.length>0&&(e.config.tools=A);let _={model:v,config:e.config,callbacks:e.callbacks};return T=this.apiClient.isVertexAI()?function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["setup","model"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["generationConfig"]);void 0!==t&&null!=n&&en(t,["setup","generationConfig"],n);let l=el(e,["responseModalities"]);void 0!==t&&null!=l&&en(t,["setup","generationConfig","responseModalities"],l);let i=el(e,["temperature"]);void 0!==t&&null!=i&&en(t,["setup","generationConfig","temperature"],i);let r=el(e,["topP"]);void 0!==t&&null!=r&&en(t,["setup","generationConfig","topP"],r);let o=el(e,["topK"]);void 0!==t&&null!=o&&en(t,["setup","generationConfig","topK"],o);let a=el(e,["maxOutputTokens"]);void 0!==t&&null!=a&&en(t,["setup","generationConfig","maxOutputTokens"],a);let s=el(e,["mediaResolution"]);void 0!==t&&null!=s&&en(t,["setup","generationConfig","mediaResolution"],s);let u=el(e,["seed"]);void 0!==t&&null!=u&&en(t,["setup","generationConfig","seed"],u);let p=el(e,["speechConfig"]);void 0!==t&&null!=p&&en(t,["setup","generationConfig","speechConfig"],function(e){let t={},n=el(e,["voiceConfig"]);if(null!=n&&en(t,["voiceConfig"],function(e){let t={},n=el(e,["prebuiltVoiceConfig"]);return null!=n&&en(t,["prebuiltVoiceConfig"],function(e){let t={},n=el(e,["voiceName"]);return null!=n&&en(t,["voiceName"],n),t}(n)),t}(n)),void 0!==el(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let l=el(e,["languageCode"]);return null!=l&&en(t,["languageCode"],l),t}(eJ(p)));let c=el(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&en(t,["setup","generationConfig","enableAffectiveDialog"],c);let d=el(e,["systemInstruction"]);void 0!==t&&null!=d&&en(t,["setup","systemInstruction"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["data"]);null!=l&&en(t,["data"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={},n=el(e,["displayName"]);null!=n&&en(t,["displayName"],n);let l=el(e,["fileUri"]);null!=l&&en(t,["fileUri"],l);let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(eG(d)));let f=el(e,["tools"]);if(void 0!==t&&null!=f){let e=eY(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==el(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=el(e,["description"]);null!=n&&en(t,["description"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["parameters"]);null!=i&&en(t,["parameters"],i);let r=el(e,["parametersJsonSchema"]);null!=r&&en(t,["parametersJsonSchema"],r);let o=el(e,["response"]);null!=o&&en(t,["response"],o);let a=el(e,["responseJsonSchema"]);return null!=a&&en(t,["responseJsonSchema"],a),t})(e))),en(t,["functionDeclarations"],e)}let l=el(e,["retrieval"]);null!=l&&en(t,["retrieval"],l);let i=el(e,["googleSearch"]);null!=i&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n));let l=el(e,["excludeDomains"]);return null!=l&&en(t,["excludeDomains"],l),t}(i));let r=el(e,["googleSearchRetrieval"]);null!=r&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(r));let o=el(e,["enterpriseWebSearch"]);null!=o&&en(t,["enterpriseWebSearch"],function(e){let t={},n=el(e,["excludeDomains"]);return null!=n&&en(t,["excludeDomains"],n),t}(o));let a=el(e,["googleMaps"]);null!=a&&en(t,["googleMaps"],function(e){let t={},n=el(e,["authConfig"]);return null!=n&&en(t,["authConfig"],function(e){let t={},n=el(e,["apiKeyConfig"]);null!=n&&en(t,["apiKeyConfig"],function(e){let t={},n=el(e,["apiKeyString"]);return null!=n&&en(t,["apiKeyString"],n),t}(n));let l=el(e,["authType"]);null!=l&&en(t,["authType"],l);let i=el(e,["googleServiceAccountConfig"]);null!=i&&en(t,["googleServiceAccountConfig"],i);let r=el(e,["httpBasicAuthConfig"]);null!=r&&en(t,["httpBasicAuthConfig"],r);let o=el(e,["oauthConfig"]);null!=o&&en(t,["oauthConfig"],o);let a=el(e,["oidcConfig"]);return null!=a&&en(t,["oidcConfig"],a),t}(n)),t}(a)),null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let s=el(e,["computerUse"]);null!=s&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(s));let u=el(e,["codeExecution"]);return null!=u&&en(t,["codeExecution"],u),t})(eB(e)))),en(t,["setup","tools"],e)}let m=el(e,["sessionResumption"]);void 0!==t&&null!=m&&en(t,["setup","sessionResumption"],function(e){let t={},n=el(e,["handle"]);null!=n&&en(t,["handle"],n);let l=el(e,["transparent"]);return null!=l&&en(t,["transparent"],l),t}(m));let h=el(e,["inputAudioTranscription"]);void 0!==t&&null!=h&&en(t,["setup","inputAudioTranscription"],{});let g=el(e,["outputAudioTranscription"]);void 0!==t&&null!=g&&en(t,["setup","outputAudioTranscription"],{});let y=el(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&en(t,["setup","realtimeInputConfig"],function(e){let t={},n=el(e,["automaticActivityDetection"]);null!=n&&en(t,["automaticActivityDetection"],function(e){let t={},n=el(e,["disabled"]);null!=n&&en(t,["disabled"],n);let l=el(e,["startOfSpeechSensitivity"]);null!=l&&en(t,["startOfSpeechSensitivity"],l);let i=el(e,["endOfSpeechSensitivity"]);null!=i&&en(t,["endOfSpeechSensitivity"],i);let r=el(e,["prefixPaddingMs"]);null!=r&&en(t,["prefixPaddingMs"],r);let o=el(e,["silenceDurationMs"]);return null!=o&&en(t,["silenceDurationMs"],o),t}(n));let l=el(e,["activityHandling"]);null!=l&&en(t,["activityHandling"],l);let i=el(e,["turnCoverage"]);return null!=i&&en(t,["turnCoverage"],i),t}(y));let C=el(e,["contextWindowCompression"]);void 0!==t&&null!=C&&en(t,["setup","contextWindowCompression"],function(e){let t={},n=el(e,["triggerTokens"]);null!=n&&en(t,["triggerTokens"],n);let l=el(e,["slidingWindow"]);return null!=l&&en(t,["slidingWindow"],function(e){let t={},n=el(e,["targetTokens"]);return null!=n&&en(t,["targetTokens"],n),t}(l)),t}(C));let v=el(e,["proactivity"]);return void 0!==t&&null!=v&&en(t,["setup","proactivity"],function(e){let t={},n=el(e,["proactiveAudio"]);return null!=n&&en(t,["proactiveAudio"],n),t}(v)),{}}(i,n)),n}(this.apiClient,_):function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["setup","model"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["generationConfig"]);void 0!==t&&null!=n&&en(t,["setup","generationConfig"],n);let l=el(e,["responseModalities"]);void 0!==t&&null!=l&&en(t,["setup","generationConfig","responseModalities"],l);let i=el(e,["temperature"]);void 0!==t&&null!=i&&en(t,["setup","generationConfig","temperature"],i);let r=el(e,["topP"]);void 0!==t&&null!=r&&en(t,["setup","generationConfig","topP"],r);let o=el(e,["topK"]);void 0!==t&&null!=o&&en(t,["setup","generationConfig","topK"],o);let a=el(e,["maxOutputTokens"]);void 0!==t&&null!=a&&en(t,["setup","generationConfig","maxOutputTokens"],a);let s=el(e,["mediaResolution"]);void 0!==t&&null!=s&&en(t,["setup","generationConfig","mediaResolution"],s);let u=el(e,["seed"]);void 0!==t&&null!=u&&en(t,["setup","generationConfig","seed"],u);let p=el(e,["speechConfig"]);void 0!==t&&null!=p&&en(t,["setup","generationConfig","speechConfig"],function(e){let t={},n=el(e,["voiceConfig"]);null!=n&&en(t,["voiceConfig"],th(n));let l=el(e,["multiSpeakerVoiceConfig"]);null!=l&&en(t,["multiSpeakerVoiceConfig"],function(e){let t={},n=el(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["speaker"]);null!=n&&en(t,["speaker"],n);let l=el(e,["voiceConfig"]);return null!=l&&en(t,["voiceConfig"],th(l)),t})(e))),en(t,["speakerVoiceConfigs"],e)}return t}(l));let i=el(e,["languageCode"]);return null!=i&&en(t,["languageCode"],i),t}(eJ(p)));let c=el(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&en(t,["setup","generationConfig","enableAffectiveDialog"],c);let d=el(e,["systemInstruction"]);void 0!==t&&null!=d&&en(t,["setup","systemInstruction"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(eG(d)));let f=el(e,["tools"]);if(void 0!==t&&null!=f){let e=eY(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["behavior"]);null!=n&&en(t,["behavior"],n);let l=el(e,["description"]);null!=l&&en(t,["description"],l);let i=el(e,["name"]);null!=i&&en(t,["name"],i);let r=el(e,["parameters"]);null!=r&&en(t,["parameters"],r);let o=el(e,["parametersJsonSchema"]);null!=o&&en(t,["parametersJsonSchema"],o);let a=el(e,["response"]);null!=a&&en(t,["response"],a);let s=el(e,["responseJsonSchema"]);return null!=s&&en(t,["responseJsonSchema"],s),t})(e))),en(t,["functionDeclarations"],e)}if(void 0!==el(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let l=el(e,["googleSearch"]);null!=l&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);if(null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n)),void 0!==el(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(l));let i=el(e,["googleSearchRetrieval"]);if(null!=i&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(i)),void 0!==el(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==el(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let r=el(e,["computerUse"]);null!=r&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(r));let o=el(e,["codeExecution"]);return null!=o&&en(t,["codeExecution"],o),t})(eB(e)))),en(t,["setup","tools"],e)}let m=el(e,["sessionResumption"]);void 0!==t&&null!=m&&en(t,["setup","sessionResumption"],function(e){let t={},n=el(e,["handle"]);if(null!=n&&en(t,["handle"],n),void 0!==el(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let h=el(e,["inputAudioTranscription"]);void 0!==t&&null!=h&&en(t,["setup","inputAudioTranscription"],{});let g=el(e,["outputAudioTranscription"]);void 0!==t&&null!=g&&en(t,["setup","outputAudioTranscription"],{});let y=el(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&en(t,["setup","realtimeInputConfig"],function(e){let t={},n=el(e,["automaticActivityDetection"]);null!=n&&en(t,["automaticActivityDetection"],function(e){let t={},n=el(e,["disabled"]);null!=n&&en(t,["disabled"],n);let l=el(e,["startOfSpeechSensitivity"]);null!=l&&en(t,["startOfSpeechSensitivity"],l);let i=el(e,["endOfSpeechSensitivity"]);null!=i&&en(t,["endOfSpeechSensitivity"],i);let r=el(e,["prefixPaddingMs"]);null!=r&&en(t,["prefixPaddingMs"],r);let o=el(e,["silenceDurationMs"]);return null!=o&&en(t,["silenceDurationMs"],o),t}(n));let l=el(e,["activityHandling"]);null!=l&&en(t,["activityHandling"],l);let i=el(e,["turnCoverage"]);return null!=i&&en(t,["turnCoverage"],i),t}(y));let C=el(e,["contextWindowCompression"]);void 0!==t&&null!=C&&en(t,["setup","contextWindowCompression"],function(e){let t={},n=el(e,["triggerTokens"]);null!=n&&en(t,["triggerTokens"],n);let l=el(e,["slidingWindow"]);return null!=l&&en(t,["slidingWindow"],function(e){let t={},n=el(e,["targetTokens"]);return null!=n&&en(t,["targetTokens"],n),t}(l)),t}(C));let v=el(e,["proactivity"]);return void 0!==t&&null!=v&&en(t,["setup","proactivity"],function(e){let t={},n=el(e,["proactiveAudio"]);return null!=n&&en(t,["proactiveAudio"],n),t}(v)),{}}(i,n)),n}(this.apiClient,_),delete T.config,y.send(JSON.stringify(T)),new t2(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new tQ(this.apiClient,this.auth,this.webSocketFactory)}}let t1={turnComplete:!0};class t2{tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=eF(t.turns),n=e.isVertexAI()?n.map(e=>tN(e)):n.map(e=>tI(e))}catch(e){throw Error('Failed to parse client content "turns", type: \''.concat(typeof t.turns,"'"))}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses||0===(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error("Could not parse function response, type '".concat(typeof t,"'."));if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},t1),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},n=el(e,["media"]);null!=n&&en(t,["mediaChunks"],eP(n));let l=el(e,["audio"]);null!=l&&en(t,["audio"],ex(l));let i=el(e,["audioStreamEnd"]);null!=i&&en(t,["audioStreamEnd"],i);let r=el(e,["video"]);null!=r&&en(t,["video"],eD(r));let o=el(e,["text"]);return null!=o&&en(t,["text"],o),null!=el(e,["activityStart"])&&en(t,["activityStart"],{}),null!=el(e,["activityEnd"])&&en(t,["activityEnd"],{}),t}(e)}:{realtimeInput:function(e){let t={},n=el(e,["media"]);null!=n&&en(t,["mediaChunks"],eP(n));let l=el(e,["audio"]);null!=l&&en(t,["audio"],ex(l));let i=el(e,["audioStreamEnd"]);null!=i&&en(t,["audioStreamEnd"],i);let r=el(e,["video"]);null!=r&&en(t,["video"],eD(r));let o=el(e,["text"]);return null!=o&&en(t,["text"],o),null!=el(e,["activityStart"])&&en(t,["activityStart"],{}),null!=el(e,["activityEnd"])&&en(t,["activityEnd"],{}),t}(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}constructor(e,t){this.conn=e,this.apiClient=t}}function t6(e){var t,n,l;if(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.disable)return!0;let i=!1;for(let t of null!=(n=null==e?void 0:e.tools)?n:[])if(t3(t)){i=!0;break}if(!i)return!0;let r=null==(l=null==e?void 0:e.automaticFunctionCalling)?void 0:l.maximumRemoteCalls;return(!(!r||!(r<0)&&Number.isInteger(r))||0==r)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0)}function t3(e){return"callTool"in e&&"function"==typeof e.callTool}function t4(e){var t;return!(null==(t=null==e?void 0:e.automaticFunctionCalling)?void 0:t.ignoreCallHistory)}class t5 extends ee{maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema)}async processParamsMaybeAddMcpUsage(e){var t,n,l;let i=null==(t=e.config)?void 0:t.tools;if(!i)return e;let r=await Promise.all(i.map(async e=>t3(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:r})};if(o.config.tools=r,e.config&&e.config.tools&&tW(e.config.tools)){let t=Object.assign({},null!=(l=null==(n=e.config.httpOptions)?void 0:n.headers)?l:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),tK(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t})}return o}async initAfcToolsMap(e){var t,n,l;let i=new Map;for(let r of null!=(n=null==(t=e.config)?void 0:t.tools)?n:[])if(t3(r))for(let e of null!=(l=(await r.tool()).functionDeclarations)?l:[]){if(!e.name)throw Error("Function declaration name is required.");if(i.has(e.name))throw Error("Duplicate tool declaration name: ".concat(e.name));i.set(e.name,r)}return i}async processAfcStream(e){var t,n,l;let i=null!=(l=null==(n=null==(t=e.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?l:10,r=!1,o=0;return function(e,t,n){var l,a;return to(this,arguments,function*(){for(var s,u,p,c;o<i;){r&&(o++,r=!1);let h=yield tr(e.processParamsMaybeAddMcpUsage(n)),g=yield tr(e.generateContentStreamInternal(h)),y=[],C=[];try{for(var d,f=!0,m=(u=void 0,ta(g));!(s=(d=yield tr(m.next())).done);f=!0)if(c=d.value,f=!1,yield yield tr(c),c.candidates&&(null==(l=c.candidates[0])?void 0:l.content)){for(let e of(C.push(c.candidates[0].content),null!=(a=c.candidates[0].content.parts)?a:[]))if(o<i&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let n=yield tr(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...n)}else throw Error("Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ".concat(t.keys(),", mising tool: ").concat(e.functionCall.name))}}}catch(e){u={error:e}}finally{try{!f&&!s&&(p=m.return)&&(yield tr(p.call(m)))}finally{if(u)throw u.error}}if(y.length>0){r=!0;let e=new eo;e.candidates=[{content:{role:"user",parts:y}}],yield yield tr(e);let t=[];t.push(...C),t.push({role:"user",parts:y});let l=eF(n.contents).concat(t);n.contents=l}else break}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=tM(this.apiClient,e);return r=et("{model}:generateContent",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=tq(e),n=new eo;return Object.assign(n,t),n})}{let t=tb(this.apiClient,e);return r=et("{model}:generateContent",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=tw(e),n=new eo;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=tM(this.apiClient,e);return r=et("{model}:streamGenerateContent?alt=sse",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.requestStream({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(function(e){return to(this,arguments,function*(){var t,n,l,i;try{for(var r,o=!0,a=ta(e);!(t=(r=yield tr(a.next())).done);o=!0){i=r.value,o=!1;let e=tq((yield tr(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new eo;Object.assign(t,e),yield yield tr(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(l=a.return)&&(yield tr(l.call(a)))}finally{if(n)throw n.error}}})})}{let t=tb(this.apiClient,e);return r=et("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.requestStream({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(function(e){return to(this,arguments,function*(){var t,n,l,i;try{for(var r,o=!0,a=ta(e);!(t=(r=yield tr(a.next())).done);o=!0){i=r.value,o=!1;let e=tw((yield tr(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new eo;Object.assign(t,e),yield yield tr(t)}}catch(e){n={error:e}}finally{try{!o&&!t&&(l=a.return)&&(yield tr(l.call(a)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["contents"]);null!=i&&en(n,["instances[]","content"],eH(e,i));let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){let n=el(e,["taskType"]);void 0!==t&&null!=n&&en(t,["instances[]","task_type"],n);let l=el(e,["title"]);void 0!==t&&null!=l&&en(t,["instances[]","title"],l);let i=el(e,["outputDimensionality"]);void 0!==t&&null!=i&&en(t,["parameters","outputDimensionality"],i);let r=el(e,["mimeType"]);void 0!==t&&null!=r&&en(t,["instances[]","mimeType"],r);let o=el(e,["autoTruncate"]);return void 0!==t&&null!=o&&en(t,["parameters","autoTruncate"],o),{}}(r,n)),n}(this.apiClient,e);return r=et("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["predictions[]","embeddings"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["values"]);null!=n&&en(t,["values"],n);let l=el(e,["statistics"]);return null!=l&&en(t,["statistics"],function(e){let t={},n=el(e,["truncated"]);null!=n&&en(t,["truncated"],n);let l=el(e,["token_count"]);return null!=l&&en(t,["tokenCount"],l),t}(l)),t})(e))),en(t,["embeddings"],e)}let i=el(e,["metadata"]);return null!=i&&en(t,["metadata"],function(e){let t={},n=el(e,["billableCharacterCount"]);return null!=n&&en(t,["billableCharacterCount"],n),t}(i)),t}(e),n=new ea;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["contents"]);null!=i&&en(n,["requests[]","content"],eH(e,i));let r=el(t,["config"]);null!=r&&en(n,["config"],function(e,t){let n=el(e,["taskType"]);void 0!==t&&null!=n&&en(t,["requests[]","taskType"],n);let l=el(e,["title"]);void 0!==t&&null!=l&&en(t,["requests[]","title"],l);let i=el(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&en(t,["requests[]","outputDimensionality"],i),void 0!==el(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==el(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(r,n));let o=el(t,["model"]);return void 0!==o&&en(n,["requests[]","model"],eR(e,o)),n}(this.apiClient,e);return r=et("{model}:batchEmbedContents",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["embeddings"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["values"]);return null!=n&&en(t,["values"],n),t})(e))),en(t,["embeddings"],e)}return null!=el(e,["metadata"])&&en(t,["metadata"],{}),t}(e),n=new ea;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["prompt"]);null!=i&&en(n,["instances[0]","prompt"],i);let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){let n=el(e,["outputGcsUri"]);void 0!==t&&null!=n&&en(t,["parameters","storageUri"],n);let l=el(e,["negativePrompt"]);void 0!==t&&null!=l&&en(t,["parameters","negativePrompt"],l);let i=el(e,["numberOfImages"]);void 0!==t&&null!=i&&en(t,["parameters","sampleCount"],i);let r=el(e,["aspectRatio"]);void 0!==t&&null!=r&&en(t,["parameters","aspectRatio"],r);let o=el(e,["guidanceScale"]);void 0!==t&&null!=o&&en(t,["parameters","guidanceScale"],o);let a=el(e,["seed"]);void 0!==t&&null!=a&&en(t,["parameters","seed"],a);let s=el(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&en(t,["parameters","safetySetting"],s);let u=el(e,["personGeneration"]);void 0!==t&&null!=u&&en(t,["parameters","personGeneration"],u);let p=el(e,["includeSafetyAttributes"]);void 0!==t&&null!=p&&en(t,["parameters","includeSafetyAttributes"],p);let c=el(e,["includeRaiReason"]);void 0!==t&&null!=c&&en(t,["parameters","includeRaiReason"],c);let d=el(e,["language"]);void 0!==t&&null!=d&&en(t,["parameters","language"],d);let f=el(e,["outputMimeType"]);void 0!==t&&null!=f&&en(t,["parameters","outputOptions","mimeType"],f);let m=el(e,["outputCompressionQuality"]);void 0!==t&&null!=m&&en(t,["parameters","outputOptions","compressionQuality"],m);let h=el(e,["addWatermark"]);void 0!==t&&null!=h&&en(t,["parameters","addWatermark"],h);let g=el(e,["imageSize"]);void 0!==t&&null!=g&&en(t,["parameters","sampleImageSize"],g);let y=el(e,["enhancePrompt"]);return void 0!==t&&null!=y&&en(t,["parameters","enhancePrompt"],y),{}}(r,n)),n}(this.apiClient,e);return r=et("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["predictions"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>tH(e))),en(t,["generatedImages"],e)}let i=el(e,["positivePromptSafetyAttributes"]);return null!=i&&en(t,["positivePromptSafetyAttributes"],tG(i)),t}(e),n=new es;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["prompt"]);null!=i&&en(n,["instances[0]","prompt"],i);let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){if(void 0!==el(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==el(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let n=el(e,["numberOfImages"]);void 0!==t&&null!=n&&en(t,["parameters","sampleCount"],n);let l=el(e,["aspectRatio"]);void 0!==t&&null!=l&&en(t,["parameters","aspectRatio"],l);let i=el(e,["guidanceScale"]);if(void 0!==t&&null!=i&&en(t,["parameters","guidanceScale"],i),void 0!==el(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let r=el(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&en(t,["parameters","safetySetting"],r);let o=el(e,["personGeneration"]);void 0!==t&&null!=o&&en(t,["parameters","personGeneration"],o);let a=el(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&en(t,["parameters","includeSafetyAttributes"],a);let s=el(e,["includeRaiReason"]);void 0!==t&&null!=s&&en(t,["parameters","includeRaiReason"],s);let u=el(e,["language"]);void 0!==t&&null!=u&&en(t,["parameters","language"],u);let p=el(e,["outputMimeType"]);void 0!==t&&null!=p&&en(t,["parameters","outputOptions","mimeType"],p);let c=el(e,["outputCompressionQuality"]);if(void 0!==t&&null!=c&&en(t,["parameters","outputOptions","compressionQuality"],c),void 0!==el(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");let d=el(e,["imageSize"]);if(void 0!==t&&null!=d&&en(t,["parameters","sampleImageSize"],d),void 0!==el(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(r,n)),n}(this.apiClient,e);return r=et("{model}:predict",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["predictions"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["_self"]);null!=n&&en(t,["image"],function(e){let t={},n=el(e,["bytesBase64Encoded"]);null!=n&&en(t,["imageBytes"],ei(n));let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(n));let l=el(e,["raiFilteredReason"]);null!=l&&en(t,["raiFilteredReason"],l);let i=el(e,["_self"]);return null!=i&&en(t,["safetyAttributes"],tU(i)),t})(e))),en(t,["generatedImages"],e)}let i=el(e,["positivePromptSafetyAttributes"]);return null!=i&&en(t,["positivePromptSafetyAttributes"],tU(i)),t}(e),n=new es;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["prompt"]);null!=i&&en(n,["instances[0]","prompt"],i);let r=el(t,["referenceImages"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["referenceImage"]);null!=n&&en(t,["referenceImage"],tD(n));let l=el(e,["referenceId"]);null!=l&&en(t,["referenceId"],l);let i=el(e,["referenceType"]);null!=i&&en(t,["referenceType"],i);let r=el(e,["maskImageConfig"]);null!=r&&en(t,["maskImageConfig"],function(e){let t={},n=el(e,["maskMode"]);null!=n&&en(t,["maskMode"],n);let l=el(e,["segmentationClasses"]);null!=l&&en(t,["maskClasses"],l);let i=el(e,["maskDilation"]);return null!=i&&en(t,["dilation"],i),t}(r));let o=el(e,["controlImageConfig"]);null!=o&&en(t,["controlImageConfig"],function(e){let t={},n=el(e,["controlType"]);null!=n&&en(t,["controlType"],n);let l=el(e,["enableControlImageComputation"]);return null!=l&&en(t,["computeControl"],l),t}(o));let a=el(e,["styleImageConfig"]);null!=a&&en(t,["styleImageConfig"],function(e){let t={},n=el(e,["styleDescription"]);return null!=n&&en(t,["styleDescription"],n),t}(a));let s=el(e,["subjectImageConfig"]);return null!=s&&en(t,["subjectImageConfig"],function(e){let t={},n=el(e,["subjectType"]);null!=n&&en(t,["subjectType"],n);let l=el(e,["subjectDescription"]);return null!=l&&en(t,["subjectDescription"],l),t}(s)),t})(e))),en(n,["instances[0]","referenceImages"],e)}let o=el(t,["config"]);return null!=o&&en(n,["config"],function(e,t){let n=el(e,["outputGcsUri"]);void 0!==t&&null!=n&&en(t,["parameters","storageUri"],n);let l=el(e,["negativePrompt"]);void 0!==t&&null!=l&&en(t,["parameters","negativePrompt"],l);let i=el(e,["numberOfImages"]);void 0!==t&&null!=i&&en(t,["parameters","sampleCount"],i);let r=el(e,["aspectRatio"]);void 0!==t&&null!=r&&en(t,["parameters","aspectRatio"],r);let o=el(e,["guidanceScale"]);void 0!==t&&null!=o&&en(t,["parameters","guidanceScale"],o);let a=el(e,["seed"]);void 0!==t&&null!=a&&en(t,["parameters","seed"],a);let s=el(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&en(t,["parameters","safetySetting"],s);let u=el(e,["personGeneration"]);void 0!==t&&null!=u&&en(t,["parameters","personGeneration"],u);let p=el(e,["includeSafetyAttributes"]);void 0!==t&&null!=p&&en(t,["parameters","includeSafetyAttributes"],p);let c=el(e,["includeRaiReason"]);void 0!==t&&null!=c&&en(t,["parameters","includeRaiReason"],c);let d=el(e,["language"]);void 0!==t&&null!=d&&en(t,["parameters","language"],d);let f=el(e,["outputMimeType"]);void 0!==t&&null!=f&&en(t,["parameters","outputOptions","mimeType"],f);let m=el(e,["outputCompressionQuality"]);void 0!==t&&null!=m&&en(t,["parameters","outputOptions","compressionQuality"],m);let h=el(e,["addWatermark"]);void 0!==t&&null!=h&&en(t,["parameters","addWatermark"],h);let g=el(e,["editMode"]);void 0!==t&&null!=g&&en(t,["parameters","editMode"],g);let y=el(e,["baseSteps"]);return void 0!==t&&null!=y&&en(t,["parameters","editConfig","baseSteps"],y),{}}(o,n)),n}(this.apiClient,e);return l=et("{model}:predict",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["predictions"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>tH(e))),en(t,["generatedImages"],e)}return t}(e),n=new eu;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["image"]);null!=i&&en(n,["instances[0]","image"],tD(i));let r=el(t,["upscaleFactor"]);null!=r&&en(n,["parameters","upscaleConfig","upscaleFactor"],r);let o=el(t,["config"]);return null!=o&&en(n,["config"],function(e,t){let n=el(e,["outputGcsUri"]);void 0!==t&&null!=n&&en(t,["parameters","storageUri"],n);let l=el(e,["includeRaiReason"]);void 0!==t&&null!=l&&en(t,["parameters","includeRaiReason"],l);let i=el(e,["outputMimeType"]);void 0!==t&&null!=i&&en(t,["parameters","outputOptions","mimeType"],i);let r=el(e,["outputCompressionQuality"]);void 0!==t&&null!=r&&en(t,["parameters","outputOptions","compressionQuality"],r);let o=el(e,["enhanceInputImage"]);void 0!==t&&null!=o&&en(t,["parameters","upscaleConfig","enhanceInputImage"],o);let a=el(e,["imagePreservationFactor"]);void 0!==t&&null!=a&&en(t,["parameters","upscaleConfig","imagePreservationFactor"],a);let s=el(e,["numberOfImages"]);void 0!==t&&null!=s&&en(t,["parameters","sampleCount"],s);let u=el(e,["mode"]);return void 0!==t&&null!=u&&en(t,["parameters","mode"],u),{}}(o,n)),n}(this.apiClient,e);return l=et("{model}:predict",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["predictions"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>tH(e))),en(t,["generatedImages"],e)}return t}(e),n=new ep;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["source"]);null!=i&&en(n,["config"],function(e,t){let n=el(e,["prompt"]);void 0!==t&&null!=n&&en(t,["instances[0]","prompt"],n);let l=el(e,["personImage"]);void 0!==t&&null!=l&&en(t,["instances[0]","personImage","image"],tD(l));let i=el(e,["productImages"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["productImage"]);return null!=n&&en(t,["image"],tD(n)),t})(e))),en(t,["instances[0]","productImages"],e)}return{}}(i,n));let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){let n=el(e,["numberOfImages"]);void 0!==t&&null!=n&&en(t,["parameters","sampleCount"],n);let l=el(e,["baseSteps"]);void 0!==t&&null!=l&&en(t,["parameters","editConfig","baseSteps"],l);let i=el(e,["outputGcsUri"]);void 0!==t&&null!=i&&en(t,["parameters","storageUri"],i);let r=el(e,["seed"]);void 0!==t&&null!=r&&en(t,["parameters","seed"],r);let o=el(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&en(t,["parameters","safetySetting"],o);let a=el(e,["personGeneration"]);void 0!==t&&null!=a&&en(t,["parameters","personGeneration"],a);let s=el(e,["addWatermark"]);void 0!==t&&null!=s&&en(t,["parameters","addWatermark"],s);let u=el(e,["outputMimeType"]);void 0!==t&&null!=u&&en(t,["parameters","outputOptions","mimeType"],u);let p=el(e,["outputCompressionQuality"]);void 0!==t&&null!=p&&en(t,["parameters","outputOptions","compressionQuality"],p);let c=el(e,["enhancePrompt"]);return void 0!==t&&null!=c&&en(t,["parameters","enhancePrompt"],c),{}}(r,n)),n}(this.apiClient,e);return l=et("{model}:predict",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=el(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>tH(e))),en(t,["generatedImages"],e)}return t}(e),n=new ec;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["source"]);null!=i&&en(n,["config"],function(e,t){let n=el(e,["prompt"]);void 0!==t&&null!=n&&en(t,["instances[0]","prompt"],n);let l=el(e,["image"]);void 0!==t&&null!=l&&en(t,["instances[0]","image"],tD(l));let i=el(e,["scribbleImage"]);return void 0!==t&&null!=i&&en(t,["instances[0]","scribble"],function(e){let t={},n=el(e,["image"]);return null!=n&&en(t,["image"],tD(n)),t}(i)),{}}(i,n));let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){let n=el(e,["mode"]);void 0!==t&&null!=n&&en(t,["parameters","mode"],n);let l=el(e,["maxPredictions"]);void 0!==t&&null!=l&&en(t,["parameters","maxPredictions"],l);let i=el(e,["confidenceThreshold"]);void 0!==t&&null!=i&&en(t,["parameters","confidenceThreshold"],i);let r=el(e,["maskDilation"]);void 0!==t&&null!=r&&en(t,["parameters","maskDilation"],r);let o=el(e,["binaryColorThreshold"]);return void 0!==t&&null!=o&&en(t,["parameters","binaryColorThreshold"],o),{}}(r,n)),n}(this.apiClient,e);return l=et("{model}:predict",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=el(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["_self"]);null!=n&&en(t,["mask"],tL(n));let l=el(e,["labels"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["label"]);null!=n&&en(t,["label"],n);let l=el(e,["score"]);return null!=l&&en(t,["score"],l),t})(e))),en(t,["labels"],e)}return t})(e))),en(t,["generatedMasks"],e)}return t}(e),n=new ed;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","name"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>tF(e))}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","name"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tk(e))}}async listInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["config"]);return null!=l&&en(n,["config"],function(e,t,n){let l=el(t,["pageSize"]);void 0!==n&&null!=l&&en(n,["_query","pageSize"],l);let i=el(t,["pageToken"]);void 0!==n&&null!=i&&en(n,["_query","pageToken"],i);let r=el(t,["filter"]);void 0!==n&&null!=r&&en(n,["_query","filter"],r);let o=el(t,["queryBase"]);return void 0!==n&&null!=o&&en(n,["_url","models_url"],eX(e,o)),{}}(e,l,n)),n}(this.apiClient,e);return r=et("{models_url}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["_self"]);if(null!=i){let e=eQ(i);Array.isArray(e)&&(e=e.map(e=>tF(e))),en(t,["models"],e)}return t}(e),n=new ef;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=el(t,["config"]);return null!=l&&en(n,["config"],function(e,t,n){let l=el(t,["pageSize"]);void 0!==n&&null!=l&&en(n,["_query","pageSize"],l);let i=el(t,["pageToken"]);void 0!==n&&null!=i&&en(n,["_query","pageToken"],i);let r=el(t,["filter"]);void 0!==n&&null!=r&&en(n,["_query","filter"],r);let o=el(t,["queryBase"]);return void 0!==n&&null!=o&&en(n,["_url","models_url"],eX(e,o)),{}}(e,l,n)),n}(this.apiClient,e);return r=et("{models_url}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["_self"]);if(null!=i){let e=eQ(i);Array.isArray(e)&&(e=e.map(e=>tk(e))),en(t,["models"],e)}return t}(e),n=new ef;return Object.assign(n,t),n})}}async update(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["displayName"]);void 0!==t&&null!=n&&en(t,["displayName"],n);let l=el(e,["description"]);void 0!==t&&null!=l&&en(t,["description"],l);let i=el(e,["defaultCheckpointId"]);return void 0!==t&&null!=i&&en(t,["defaultCheckpointId"],i),{}}(i,n)),n}(this.apiClient,e);return r=et("{model}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"PATCH",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>tF(e))}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","name"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["displayName"]);void 0!==t&&null!=n&&en(t,["displayName"],n);let l=el(e,["description"]);void 0!==t&&null!=l&&en(t,["description"],l);let i=el(e,["defaultCheckpointId"]);return void 0!==t&&null!=i&&en(t,["defaultCheckpointId"],i),{}}(i,n)),n}(this.apiClient,e);return r=et("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tk(e))}}async delete(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","name"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);return null!=n&&en(t,["sdkHttpResponse"],n),t}(e),n=new em;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","name"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],i),n}(this.apiClient,e);return r=et("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);return null!=n&&en(t,["sdkHttpResponse"],n),t}(e),n=new em;return Object.assign(n,t),n})}}async countTokens(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["contents"]);if(null!=i){let e=eF(i);Array.isArray(e)&&(e=e.map(e=>tN(e))),en(n,["contents"],e)}let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e,t){let n=el(e,["systemInstruction"]);void 0!==t&&null!=n&&en(t,["systemInstruction"],tN(eG(n)));let l=el(e,["tools"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>tP(e))),en(t,["tools"],e)}let i=el(e,["generationConfig"]);return void 0!==t&&null!=i&&en(t,["generationConfig"],i),{}}(r,n)),n}(this.apiClient,e);return r=et("{model}:countTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["totalTokens"]);return null!=l&&en(t,["totalTokens"],l),t}(e),n=new eh;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["contents"]);if(null!=i){let e=eF(i);Array.isArray(e)&&(e=e.map(e=>tI(e))),en(n,["contents"],e)}let r=el(t,["config"]);return null!=r&&en(n,["config"],function(e){if(void 0!==el(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==el(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==el(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.");return{}}(r)),n}(this.apiClient,e);return r=et("{model}:countTokens",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["totalTokens"]);null!=l&&en(t,["totalTokens"],l);let i=el(e,["cachedContentTokenCount"]);return null!=i&&en(t,["cachedContentTokenCount"],i),t}(e),n=new eh;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["contents"]);if(null!=i){let e=eF(i);Array.isArray(e)&&(e=e.map(e=>tN(e))),en(n,["contents"],e)}let r=el(t,["config"]);return null!=r&&en(n,["config"],r),n}(this.apiClient,e);return l=et("{model}:computeTokens",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["tokensInfo"]);return null!=l&&en(t,["tokensInfo"],l),t}(e),n=new eg;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["prompt"]);null!=i&&en(n,["instances[0]","prompt"],i);let r=el(t,["image"]);null!=r&&en(n,["instances[0]","image"],tD(r));let o=el(t,["video"]);null!=o&&en(n,["instances[0]","video"],tx(o));let a=el(t,["source"]);null!=a&&en(n,["config"],function(e,t){let n=el(e,["prompt"]);void 0!==t&&null!=n&&en(t,["instances[0]","prompt"],n);let l=el(e,["image"]);void 0!==t&&null!=l&&en(t,["instances[0]","image"],tD(l));let i=el(e,["video"]);return void 0!==t&&null!=i&&en(t,["instances[0]","video"],tx(i)),{}}(a,n));let s=el(t,["config"]);return null!=s&&en(n,["config"],function(e,t){let n=el(e,["numberOfVideos"]);void 0!==t&&null!=n&&en(t,["parameters","sampleCount"],n);let l=el(e,["outputGcsUri"]);void 0!==t&&null!=l&&en(t,["parameters","storageUri"],l);let i=el(e,["fps"]);void 0!==t&&null!=i&&en(t,["parameters","fps"],i);let r=el(e,["durationSeconds"]);void 0!==t&&null!=r&&en(t,["parameters","durationSeconds"],r);let o=el(e,["seed"]);void 0!==t&&null!=o&&en(t,["parameters","seed"],o);let a=el(e,["aspectRatio"]);void 0!==t&&null!=a&&en(t,["parameters","aspectRatio"],a);let s=el(e,["resolution"]);void 0!==t&&null!=s&&en(t,["parameters","resolution"],s);let u=el(e,["personGeneration"]);void 0!==t&&null!=u&&en(t,["parameters","personGeneration"],u);let p=el(e,["pubsubTopic"]);void 0!==t&&null!=p&&en(t,["parameters","pubsubTopic"],p);let c=el(e,["negativePrompt"]);void 0!==t&&null!=c&&en(t,["parameters","negativePrompt"],c);let d=el(e,["enhancePrompt"]);void 0!==t&&null!=d&&en(t,["parameters","enhancePrompt"],d);let f=el(e,["generateAudio"]);void 0!==t&&null!=f&&en(t,["parameters","generateAudio"],f);let m=el(e,["lastFrame"]);void 0!==t&&null!=m&&en(t,["instances[0]","lastFrame"],tD(m));let h=el(e,["referenceImages"]);if(void 0!==t&&null!=h){let e=h;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["image"]);null!=n&&en(t,["image"],tD(n));let l=el(e,["referenceType"]);return null!=l&&en(t,["referenceType"],l),t})(e))),en(t,["instances[0]","referenceImages"],e)}let g=el(e,["compressionQuality"]);return void 0!==t&&null!=g&&en(t,["parameters","compressionQuality"],g),{}}(s,n)),n}(this.apiClient,e);return r=et("{model}:predictLongRunning",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["metadata"]);null!=l&&en(t,["metadata"],l);let i=el(e,["done"]);null!=i&&en(t,["done"],i);let r=el(e,["error"]);null!=r&&en(t,["error"],r);let o=el(e,["response"]);return null!=o&&en(t,["response"],function(e){let t={},n=el(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["_self"]);return null!=n&&en(t,["video"],function(e){let t={},n=el(e,["gcsUri"]);null!=n&&en(t,["uri"],n);let l=el(e,["bytesBase64Encoded"]);null!=l&&en(t,["videoBytes"],ei(l));let i=el(e,["mimeType"]);return null!=i&&en(t,["mimeType"],i),t}(n)),t})(e))),en(t,["generatedVideos"],e)}let l=el(e,["raiMediaFilteredCount"]);null!=l&&en(t,["raiMediaFilteredCount"],l);let i=el(e,["raiMediaFilteredReasons"]);return null!=i&&en(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),n=new eC;return Object.assign(n,t),n})}{let t=function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["_url","model"],eR(e,l));let i=el(t,["prompt"]);null!=i&&en(n,["instances[0]","prompt"],i);let r=el(t,["image"]);if(null!=r&&en(n,["instances[0]","image"],tR(r)),void 0!==el(t,["video"]))throw Error("video parameter is not supported in Gemini API.");let o=el(t,["source"]);null!=o&&en(n,["config"],function(e,t){let n=el(e,["prompt"]);void 0!==t&&null!=n&&en(t,["instances[0]","prompt"],n);let l=el(e,["image"]);if(void 0!==t&&null!=l&&en(t,["instances[0]","image"],tR(l)),void 0!==el(e,["video"]))throw Error("video parameter is not supported in Gemini API.");return{}}(o,n));let a=el(t,["config"]);return null!=a&&en(n,["config"],function(e,t){let n=el(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&en(t,["parameters","sampleCount"],n),void 0!==el(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==el(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let l=el(e,["durationSeconds"]);if(void 0!==t&&null!=l&&en(t,["parameters","durationSeconds"],l),void 0!==el(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let i=el(e,["aspectRatio"]);if(void 0!==t&&null!=i&&en(t,["parameters","aspectRatio"],i),void 0!==el(e,["resolution"]))throw Error("resolution parameter is not supported in Gemini API.");let r=el(e,["personGeneration"]);if(void 0!==t&&null!=r&&en(t,["parameters","personGeneration"],r),void 0!==el(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let o=el(e,["negativePrompt"]);void 0!==t&&null!=o&&en(t,["parameters","negativePrompt"],o);let a=el(e,["enhancePrompt"]);if(void 0!==t&&null!=a&&en(t,["parameters","enhancePrompt"],a),void 0!==el(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");if(void 0!==el(e,["lastFrame"]))throw Error("lastFrame parameter is not supported in Gemini API.");if(void 0!==el(e,["referenceImages"]))throw Error("referenceImages parameter is not supported in Gemini API.");if(void 0!==el(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.");return{}}(a,n)),n}(this.apiClient,e);return r=et("{model}:predictLongRunning",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["name"],n);let l=el(e,["metadata"]);null!=l&&en(t,["metadata"],l);let i=el(e,["done"]);null!=i&&en(t,["done"],i);let r=el(e,["error"]);null!=r&&en(t,["error"],r);let o=el(e,["response","generateVideoResponse"]);return null!=o&&en(t,["response"],function(e){let t={},n=el(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["_self"]);return null!=n&&en(t,["video"],function(e){let t={},n=el(e,["video","uri"]);null!=n&&en(t,["uri"],n);let l=el(e,["video","encodedVideo"]);null!=l&&en(t,["videoBytes"],ei(l));let i=el(e,["encoding"]);return null!=i&&en(t,["mimeType"],i),t}(n)),t})(e))),en(t,["generatedVideos"],e)}let l=el(e,["raiMediaFilteredCount"]);null!=l&&en(t,["raiMediaFilteredCount"],l);let i=el(e,["raiMediaFilteredReasons"]);return null!=i&&en(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),n=new eC;return Object.assign(n,t),n})}}constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,l,i,r;let o,a,s=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,n,l;return null!=(l=null==(n=null==(t=e.config)?void 0:t.tools)?void 0:n.some(e=>t3(e)))&&l}(e)||t6(e.config))return await this.generateContentInternal(s);if(function(e){var t,n,l;return null!=(l=null==(n=null==(t=e.config)?void 0:t.tools)?void 0:n.some(e=>!t3(e)))&&l}(e))throw Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u=eF(s.contents),p=null!=(l=null==(n=null==(t=s.config)?void 0:t.automaticFunctionCalling)?void 0:n.maximumRemoteCalls)?l:10,c=0;for(;c<p&&(o=await this.generateContentInternal(s)).functionCalls&&0!==o.functionCalls.length;){let t=o.candidates[0].content,n=[];for(let t of null!=(r=null==(i=e.config)?void 0:i.tools)?r:[])if(t3(t)){let e=await t.callTool(o.functionCalls);n.push(...e)}c++,a={role:"user",parts:n},s.contents=eF(s.contents),s.contents.push(t),s.contents.push(a),t4(s.config)&&(u.push(t),u.push(a))}return t4(s.config)&&(o.automaticFunctionCallingHistory=u),o},this.generateContentStream=async e=>{if(this.maybeMoveToResponseJsonSchem(e),!t6(e.config))return await this.processAfcStream(e);{let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n,l=[];if(null==e?void 0:e.generatedImages)for(let i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&(null==(t=null==i?void 0:i.safetyAttributes)?void 0:t.contentType)==="Positive Prompt"?n=null==i?void 0:i.safetyAttributes:l.push(i);return n?{generatedImages:l,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:l,sdkHttpResponse:e.sdkHttpResponse}}),this.list=async e=>{var t;let n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase)if(null==(t=n.config)?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else n.config.filter="labels.tune-type:*";return new e9(z.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(e)}}}class t8 extends ee{async getVideosOperation(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,l=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:l,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,isVertexAI:!1})}}async get(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e,l=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:l,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e){let t={},n=el(e,["operationName"]);null!=n&&en(t,["_url","operationName"],n);let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);return r=et("{operationName}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}{let t=function(e){let t={},n=el(e,["operationName"]);null!=n&&en(t,["_url","operationName"],n);let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);return r=et("{operationName}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json())}}async fetchPredictVideosOperationInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let r=function(e){let t={},n=el(e,["operationName"]);null!=n&&en(t,["operationName"],n);let l=el(e,["resourceName"]);null!=l&&en(t,["_url","resourceName"],l);let i=el(e,["config"]);return null!=i&&en(t,["config"],i),t}(e);return l=et("{resourceName}:fetchPredictOperation",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json())}throw Error("This method is only supported by the Vertex AI.")}constructor(e){super(),this.apiClient=e}}function t9(e){let t={},n=el(e,["prebuiltVoiceConfig"]);return null!=n&&en(t,["prebuiltVoiceConfig"],function(e){let t={},n=el(e,["voiceName"]);return null!=n&&en(t,["voiceName"],n),t}(n)),t}class t7 extends ee{async create(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let r=function(e,t){let n={},l=el(t,["config"]);return null!=l&&en(n,["config"],function(e,t,n){let l=el(t,["expireTime"]);void 0!==n&&null!=l&&en(n,["expireTime"],l);let i=el(t,["newSessionExpireTime"]);void 0!==n&&null!=i&&en(n,["newSessionExpireTime"],i);let r=el(t,["uses"]);void 0!==n&&null!=r&&en(n,["uses"],r);let o=el(t,["liveConnectConstraints"]);void 0!==n&&null!=o&&en(n,["bidiGenerateContentSetup"],function(e,t){let n={},l=el(t,["model"]);null!=l&&en(n,["setup","model"],eR(e,l));let i=el(t,["config"]);return null!=i&&en(n,["config"],function(e,t){let n=el(e,["generationConfig"]);void 0!==t&&null!=n&&en(t,["setup","generationConfig"],n);let l=el(e,["responseModalities"]);void 0!==t&&null!=l&&en(t,["setup","generationConfig","responseModalities"],l);let i=el(e,["temperature"]);void 0!==t&&null!=i&&en(t,["setup","generationConfig","temperature"],i);let r=el(e,["topP"]);void 0!==t&&null!=r&&en(t,["setup","generationConfig","topP"],r);let o=el(e,["topK"]);void 0!==t&&null!=o&&en(t,["setup","generationConfig","topK"],o);let a=el(e,["maxOutputTokens"]);void 0!==t&&null!=a&&en(t,["setup","generationConfig","maxOutputTokens"],a);let s=el(e,["mediaResolution"]);void 0!==t&&null!=s&&en(t,["setup","generationConfig","mediaResolution"],s);let u=el(e,["seed"]);void 0!==t&&null!=u&&en(t,["setup","generationConfig","seed"],u);let p=el(e,["speechConfig"]);void 0!==t&&null!=p&&en(t,["setup","generationConfig","speechConfig"],function(e){let t={},n=el(e,["voiceConfig"]);null!=n&&en(t,["voiceConfig"],t9(n));let l=el(e,["multiSpeakerVoiceConfig"]);null!=l&&en(t,["multiSpeakerVoiceConfig"],function(e){let t={},n=el(e,["speakerVoiceConfigs"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["speaker"]);null!=n&&en(t,["speaker"],n);let l=el(e,["voiceConfig"]);return null!=l&&en(t,["voiceConfig"],t9(l)),t})(e))),en(t,["speakerVoiceConfigs"],e)}return t}(l));let i=el(e,["languageCode"]);return null!=i&&en(t,["languageCode"],i),t}(eJ(p)));let c=el(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&en(t,["setup","generationConfig","enableAffectiveDialog"],c);let d=el(e,["systemInstruction"]);void 0!==t&&null!=d&&en(t,["setup","systemInstruction"],function(e){let t={},n=el(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["videoMetadata"]);null!=n&&en(t,["videoMetadata"],function(e){let t={},n=el(e,["fps"]);null!=n&&en(t,["fps"],n);let l=el(e,["endOffset"]);null!=l&&en(t,["endOffset"],l);let i=el(e,["startOffset"]);return null!=i&&en(t,["startOffset"],i),t}(n));let l=el(e,["thought"]);null!=l&&en(t,["thought"],l);let i=el(e,["inlineData"]);null!=i&&en(t,["inlineData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["data"]);null!=n&&en(t,["data"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(i));let r=el(e,["fileData"]);null!=r&&en(t,["fileData"],function(e){let t={};if(void 0!==el(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=el(e,["fileUri"]);null!=n&&en(t,["fileUri"],n);let l=el(e,["mimeType"]);return null!=l&&en(t,["mimeType"],l),t}(r));let o=el(e,["thoughtSignature"]);null!=o&&en(t,["thoughtSignature"],o);let a=el(e,["codeExecutionResult"]);null!=a&&en(t,["codeExecutionResult"],a);let s=el(e,["executableCode"]);null!=s&&en(t,["executableCode"],s);let u=el(e,["functionCall"]);null!=u&&en(t,["functionCall"],u);let p=el(e,["functionResponse"]);null!=p&&en(t,["functionResponse"],p);let c=el(e,["text"]);return null!=c&&en(t,["text"],c),t})(e))),en(t,["parts"],e)}let l=el(e,["role"]);return null!=l&&en(t,["role"],l),t}(eG(d)));let f=el(e,["tools"]);if(void 0!==t&&null!=f){let e=eY(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["behavior"]);null!=n&&en(t,["behavior"],n);let l=el(e,["description"]);null!=l&&en(t,["description"],l);let i=el(e,["name"]);null!=i&&en(t,["name"],i);let r=el(e,["parameters"]);null!=r&&en(t,["parameters"],r);let o=el(e,["parametersJsonSchema"]);null!=o&&en(t,["parametersJsonSchema"],o);let a=el(e,["response"]);null!=a&&en(t,["response"],a);let s=el(e,["responseJsonSchema"]);return null!=s&&en(t,["responseJsonSchema"],s),t})(e))),en(t,["functionDeclarations"],e)}if(void 0!==el(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let l=el(e,["googleSearch"]);null!=l&&en(t,["googleSearch"],function(e){let t={},n=el(e,["timeRangeFilter"]);if(null!=n&&en(t,["timeRangeFilter"],function(e){let t={},n=el(e,["startTime"]);null!=n&&en(t,["startTime"],n);let l=el(e,["endTime"]);return null!=l&&en(t,["endTime"],l),t}(n)),void 0!==el(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(l));let i=el(e,["googleSearchRetrieval"]);if(null!=i&&en(t,["googleSearchRetrieval"],function(e){let t={},n=el(e,["dynamicRetrievalConfig"]);return null!=n&&en(t,["dynamicRetrievalConfig"],function(e){let t={},n=el(e,["mode"]);null!=n&&en(t,["mode"],n);let l=el(e,["dynamicThreshold"]);return null!=l&&en(t,["dynamicThreshold"],l),t}(n)),t}(i)),void 0!==el(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==el(e,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");null!=el(e,["urlContext"])&&en(t,["urlContext"],{});let r=el(e,["computerUse"]);null!=r&&en(t,["computerUse"],function(e){let t={},n=el(e,["environment"]);return null!=n&&en(t,["environment"],n),t}(r));let o=el(e,["codeExecution"]);return null!=o&&en(t,["codeExecution"],o),t})(eB(e)))),en(t,["setup","tools"],e)}let m=el(e,["sessionResumption"]);void 0!==t&&null!=m&&en(t,["setup","sessionResumption"],function(e){let t={},n=el(e,["handle"]);if(null!=n&&en(t,["handle"],n),void 0!==el(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let h=el(e,["inputAudioTranscription"]);void 0!==t&&null!=h&&en(t,["setup","inputAudioTranscription"],{});let g=el(e,["outputAudioTranscription"]);void 0!==t&&null!=g&&en(t,["setup","outputAudioTranscription"],{});let y=el(e,["realtimeInputConfig"]);void 0!==t&&null!=y&&en(t,["setup","realtimeInputConfig"],function(e){let t={},n=el(e,["automaticActivityDetection"]);null!=n&&en(t,["automaticActivityDetection"],function(e){let t={},n=el(e,["disabled"]);null!=n&&en(t,["disabled"],n);let l=el(e,["startOfSpeechSensitivity"]);null!=l&&en(t,["startOfSpeechSensitivity"],l);let i=el(e,["endOfSpeechSensitivity"]);null!=i&&en(t,["endOfSpeechSensitivity"],i);let r=el(e,["prefixPaddingMs"]);null!=r&&en(t,["prefixPaddingMs"],r);let o=el(e,["silenceDurationMs"]);return null!=o&&en(t,["silenceDurationMs"],o),t}(n));let l=el(e,["activityHandling"]);null!=l&&en(t,["activityHandling"],l);let i=el(e,["turnCoverage"]);return null!=i&&en(t,["turnCoverage"],i),t}(y));let C=el(e,["contextWindowCompression"]);void 0!==t&&null!=C&&en(t,["setup","contextWindowCompression"],function(e){let t={},n=el(e,["triggerTokens"]);null!=n&&en(t,["triggerTokens"],n);let l=el(e,["slidingWindow"]);return null!=l&&en(t,["slidingWindow"],function(e){let t={},n=el(e,["targetTokens"]);return null!=n&&en(t,["targetTokens"],n),t}(l)),t}(C));let v=el(e,["proactivity"]);return void 0!==t&&null!=v&&en(t,["setup","proactivity"],function(e){let t={},n=el(e,["proactiveAudio"]);return null!=n&&en(t,["proactiveAudio"],n),t}(v)),{}}(i,n)),n}(e,o));let a=el(t,["lockAdditionalFields"]);return void 0!==n&&null!=a&&en(n,["fieldMask"],a),{}}(e,l,n)),n}(this.apiClient,e);l=et("auth_tokens",r._url),i=r._query,delete r.config,delete r._url,delete r._query;let o=function(e,t){let n=null,l=e.bidiGenerateContentSetup;if("object"==typeof l&&null!==l&&"setup"in l){let t=l.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==l&&delete e.bidiGenerateContentSetup;let i=e.fieldMask;if(n){let l=function(e){let t=[];for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let l=e[n];if("object"==typeof l&&null!=l&&Object.keys(l).length>0){let e=Object.keys(l).map(e=>"".concat(n,".").concat(e));t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)l?e.fieldMask=l:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],n=[];i.length>0&&(n=i.map(e=>t.includes(e)?"generationConfig.".concat(e):e));let r=[];l&&r.push(l),n.length>0&&r.push(...n),r.length>0?e.fieldMask=r.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}(r,e.config);return this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json()).then(e=>(function(e){let t={},n=el(e,["name"]);return null!=n&&en(t,["name"],n),t})(e))}}constructor(e){super(),this.apiClient=e}}function ne(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["state"]);null!=i&&en(t,["state"],eK(i));let r=el(e,["createTime"]);null!=r&&en(t,["createTime"],r);let o=el(e,["tuningTask","startTime"]);null!=o&&en(t,["startTime"],o);let a=el(e,["tuningTask","completeTime"]);null!=a&&en(t,["endTime"],a);let s=el(e,["updateTime"]);null!=s&&en(t,["updateTime"],s);let u=el(e,["description"]);null!=u&&en(t,["description"],u);let p=el(e,["baseModel"]);null!=p&&en(t,["baseModel"],p);let c=el(e,["_self"]);null!=c&&en(t,["tunedModel"],function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["model"],n);let l=el(e,["name"]);return null!=l&&en(t,["endpoint"],l),t}(c));let d=el(e,["customBaseModel"]);null!=d&&en(t,["customBaseModel"],d);let f=el(e,["experiment"]);null!=f&&en(t,["experiment"],f);let m=el(e,["labels"]);null!=m&&en(t,["labels"],m);let h=el(e,["outputUri"]);null!=h&&en(t,["outputUri"],h);let g=el(e,["pipelineJob"]);null!=g&&en(t,["pipelineJob"],g);let y=el(e,["serviceAccount"]);null!=y&&en(t,["serviceAccount"],y);let C=el(e,["tunedModelDisplayName"]);return null!=C&&en(t,["tunedModelDisplayName"],C),t}function nt(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["state"]);null!=i&&en(t,["state"],eK(i));let r=el(e,["createTime"]);null!=r&&en(t,["createTime"],r);let o=el(e,["startTime"]);null!=o&&en(t,["startTime"],o);let a=el(e,["endTime"]);null!=a&&en(t,["endTime"],a);let s=el(e,["updateTime"]);null!=s&&en(t,["updateTime"],s);let u=el(e,["error"]);null!=u&&en(t,["error"],u);let p=el(e,["description"]);null!=p&&en(t,["description"],p);let c=el(e,["baseModel"]);null!=c&&en(t,["baseModel"],c);let d=el(e,["tunedModel"]);null!=d&&en(t,["tunedModel"],function(e){let t={},n=el(e,["model"]);null!=n&&en(t,["model"],n);let l=el(e,["endpoint"]);null!=l&&en(t,["endpoint"],l);let i=el(e,["checkpoints"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["checkpointId"]);null!=n&&en(t,["checkpointId"],n);let l=el(e,["epoch"]);null!=l&&en(t,["epoch"],l);let i=el(e,["step"]);null!=i&&en(t,["step"],i);let r=el(e,["endpoint"]);return null!=r&&en(t,["endpoint"],r),t})(e))),en(t,["checkpoints"],e)}return t}(d));let f=el(e,["preTunedModel"]);null!=f&&en(t,["preTunedModel"],f);let m=el(e,["supervisedTuningSpec"]);null!=m&&en(t,["supervisedTuningSpec"],m);let h=el(e,["tuningDataStats"]);null!=h&&en(t,["tuningDataStats"],h);let g=el(e,["encryptionSpec"]);null!=g&&en(t,["encryptionSpec"],g);let y=el(e,["partnerModelTuningSpec"]);null!=y&&en(t,["partnerModelTuningSpec"],y);let C=el(e,["customBaseModel"]);null!=C&&en(t,["customBaseModel"],C);let v=el(e,["experiment"]);null!=v&&en(t,["experiment"],v);let T=el(e,["labels"]);null!=T&&en(t,["labels"],T);let E=el(e,["outputUri"]);null!=E&&en(t,["outputUri"],E);let A=el(e,["pipelineJob"]);null!=A&&en(t,["pipelineJob"],A);let _=el(e,["serviceAccount"]);null!=_&&en(t,["serviceAccount"],_);let O=el(e,["tunedModelDisplayName"]);return null!=O&&en(t,["tunedModelDisplayName"],O),t}class nn extends ee{async getInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["_url","name"],n);let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);return r=et("{name}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>nt(e))}{let t=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["_url","name"],n);let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);return r=et("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ne(e))}}async listInternal(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e){let t={},n=el(e,["config"]);return null!=n&&en(t,["config"],function(e,t){let n=el(e,["pageSize"]);void 0!==t&&null!=n&&en(t,["_query","pageSize"],n);let l=el(e,["pageToken"]);void 0!==t&&null!=l&&en(t,["_query","pageToken"],l);let i=el(e,["filter"]);return void 0!==t&&null!=i&&en(t,["_query","filter"],i),{}}(n,t)),t}(e);return r=et("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["tuningJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>nt(e))),en(t,["tuningJobs"],e)}return t}(e),n=new ev;return Object.assign(n,t),n})}{let t=function(e){let t={},n=el(e,["config"]);return null!=n&&en(t,["config"],function(e,t){let n=el(e,["pageSize"]);void 0!==t&&null!=n&&en(t,["_query","pageSize"],n);let l=el(e,["pageToken"]);void 0!==t&&null!=l&&en(t,["_query","pageToken"],l);let i=el(e,["filter"]);return void 0!==t&&null!=i&&en(t,["_query","filter"],i),{}}(n,t)),t}(e);return r=et("tunedModels",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["nextPageToken"]);null!=l&&en(t,["nextPageToken"],l);let i=el(e,["tunedModels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>ne(e))),en(t,["tuningJobs"],e)}return t}(e),n=new ev;return Object.assign(n,t),n})}}async cancel(e){var t,n,l,i;let r="",o={};if(this.apiClient.isVertexAI()){let l=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["_url","name"],n);let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);r=et("{name}:cancel",l._url),o=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal})}else{let t=function(e){let t={},n=el(e,["name"]);null!=n&&en(t,["_url","name"],n);let l=el(e,["config"]);return null!=l&&en(t,["config"],l),t}(e);r=et("{name}:cancel",t._url),o=t._query,delete t.config,delete t._url,delete t._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null==(l=e.config)?void 0:l.httpOptions,abortSignal:null==(i=e.config)?void 0:i.abortSignal})}}async tuneInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI()){let r=function(e){let t={},n=el(e,["baseModel"]);null!=n&&en(t,["baseModel"],n);let l=el(e,["preTunedModel"]);null!=l&&en(t,["preTunedModel"],l);let i=el(e,["trainingDataset"]);null!=i&&en(t,["supervisedTuningSpec","trainingDatasetUri"],function(e,t){let n=el(e,["gcsUri"]);void 0!==t&&null!=n&&en(t,["supervisedTuningSpec","trainingDatasetUri"],n);let l=el(e,["vertexDatasetResource"]);if(void 0!==t&&null!=l&&en(t,["supervisedTuningSpec","trainingDatasetUri"],l),void 0!==el(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.");return{}}(i,t));let r=el(e,["config"]);return null!=r&&en(t,["config"],function(e,t){let n={},l=el(e,["validationDataset"]);void 0!==t&&null!=l&&en(t,["supervisedTuningSpec"],function(e,t){let n={},l=el(e,["gcsUri"]);null!=l&&en(n,["validationDatasetUri"],l);let i=el(e,["vertexDatasetResource"]);return void 0!==t&&null!=i&&en(t,["supervisedTuningSpec","trainingDatasetUri"],i),n}(l,n));let i=el(e,["tunedModelDisplayName"]);void 0!==t&&null!=i&&en(t,["tunedModelDisplayName"],i);let r=el(e,["description"]);void 0!==t&&null!=r&&en(t,["description"],r);let o=el(e,["epochCount"]);void 0!==t&&null!=o&&en(t,["supervisedTuningSpec","hyperParameters","epochCount"],o);let a=el(e,["learningRateMultiplier"]);void 0!==t&&null!=a&&en(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);let s=el(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=s&&en(t,["supervisedTuningSpec","exportLastCheckpointOnly"],s);let u=el(e,["preTunedModelCheckpointId"]);null!=u&&en(n,["preTunedModel","checkpointId"],u);let p=el(e,["adapterSize"]);if(void 0!==t&&null!=p&&en(t,["supervisedTuningSpec","hyperParameters","adapterSize"],p),void 0!==el(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==el(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");return n}(r,t)),t}(e);return l=et("tuningJobs",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>nt(e))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let l="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let r=function(e){let t={},n=el(e,["baseModel"]);null!=n&&en(t,["baseModel"],n);let l=el(e,["preTunedModel"]);null!=l&&en(t,["preTunedModel"],l);let i=el(e,["trainingDataset"]);null!=i&&en(t,["tuningTask","trainingData"],function(e){let t={};if(void 0!==el(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==el(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let n=el(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=el(e,["textInput"]);null!=n&&en(t,["textInput"],n);let l=el(e,["output"]);return null!=l&&en(t,["output"],l),t})(e))),en(t,["examples","examples"],e)}return t}(i));let r=el(e,["config"]);return null!=r&&en(t,["config"],function(e,t){let n={};if(void 0!==el(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let l=el(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=l&&en(t,["displayName"],l),void 0!==el(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let i=el(e,["epochCount"]);void 0!==t&&null!=i&&en(t,["tuningTask","hyperparameters","epochCount"],i);let r=el(e,["learningRateMultiplier"]);if(null!=r&&en(n,["tuningTask","hyperparameters","learningRateMultiplier"],r),void 0!==el(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==el(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==el(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let o=el(e,["batchSize"]);void 0!==t&&null!=o&&en(t,["tuningTask","hyperparameters","batchSize"],o);let a=el(e,["learningRate"]);return void 0!==t&&null!=a&&en(t,["tuningTask","hyperparameters","learningRate"],a),n}(r,t)),t}(e);return l=et("tunedModels",r._url),i=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:l,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null==(t=e.config)?void 0:t.httpOptions,abortSignal:null==(n=e.config)?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},n=el(e,["sdkHttpResponse"]);null!=n&&en(t,["sdkHttpResponse"],n);let l=el(e,["name"]);null!=l&&en(t,["name"],l);let i=el(e,["metadata"]);null!=i&&en(t,["metadata"],i);let r=el(e,["done"]);null!=r&&en(t,["done"],r);let o=el(e,["error"]);return null!=o&&en(t,["error"],o),t})(e))}}constructor(e){var t;super(),t=this,this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e9(z.PAGED_ITEM_TUNING_JOBS,e=>t.listInternal(e),await t.listInternal(e),e)},this.tune=async e=>{if(this.apiClient.isVertexAI())if(e.baseModel.startsWith("projects/")){let t={tunedModelName:e.baseModel},n=Object.assign(Object.assign({},e),{preTunedModel:t});return n.baseModel=void 0,await this.tuneInternal(n)}else{let t=Object.assign({},e);return await this.tuneInternal(t)}{let t=Object.assign({},e),n=await this.tuneMldevInternal(t),l="";return void 0!==n.metadata&&void 0!==n.metadata.tunedModel?l=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(l=n.name.split("/operations/")[0]),{name:l,state:T.JOB_STATE_QUEUED}}}}}class nl{async download(e,t){throw Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}let ni="x-goog-upload-status";async function nr(e,t,n){var l,i,r;let o=0,a=0,s=new er(new Response),u="upload";for(o=e.size;a<o;){let r=Math.min(8388608,o-a),p=e.slice(a,a+r);a+r>=o&&(u+=", finalize");let c=0,d=1e3;for(;c<3&&(null==(l=null==(s=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(r)}}}))?void 0:s.headers)||!l[ni]);)c++,await function(e){return new Promise(t=>setTimeout(t,e))}(d),d*=2;if(a+=r,(null==(i=null==s?void 0:s.headers)?void 0:i[ni])!=="active")break;if(o<=a)throw Error("All content has been uploaded, but the upload status is not finalized.")}let p=await (null==s?void 0:s.json());if((null==(r=null==s?void 0:s.headers)?void 0:r[ni])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return p.file}async function no(e){return{size:e.size,type:e.type}}class na{async upload(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await nr(e,t,n)}async stat(e){if("string"!=typeof e)return await no(e);throw Error("File path is not supported in browser uploader.")}}class ns{create(e,t,n){return new nu(e,t,n)}}class nu{connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}}let np="x-goog-api-key";class nc{async addAuthHeaders(e){if(null===e.get(np)){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw Error("API key is missing. Please provide a valid API key.");e.append(np,this.apiKey)}}constructor(e){this.apiKey=e}}class nd{constructor(e){var l;if(null==e.apiKey)throw Error("An API Key must be set when running in a browser");if(e.project||e.location)throw Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!=(l=e.vertexai)&&l,this.apiKey=e.apiKey;let i=function(e,l,i,r){return(null==e?void 0:e.baseUrl)?e.baseUrl:l?null!=n?n:i:null!=t?t:r}(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;let r=new nc(this.apiKey);this.apiClient=new tB({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new na,downloader:new nl}),this.models=new t5(this.apiClient),this.live=new t0(this.apiClient,r,new ns),this.batches=new e7(this.apiClient),this.chats=new tp(this.models,this.apiClient),this.caches=new ti(this.apiClient),this.files=new tm(this.apiClient),this.operations=new t8(this.apiClient),this.authTokens=new t7(this.apiClient),this.tunings=new nn(this.apiClient)}}async function nf(e){let t=new nd({apiKey:"AIzaSyDuuACtngj7dDhsx6KYCp3MAcB2aLKUVy8"}),n={mediaResolution:"MEDIA_RESOLUTION_LOW",responseMimeType:"application/json",responseSchema:{type:r.OBJECT,required:["todos"],properties:{todos:{type:r.ARRAY,items:{type:r.OBJECT,required:["text","deadline","note","timestamp","done"],properties:{text:{type:r.STRING},deadline:{type:r.STRING},note:{type:r.STRING},timestamp:{type:r.STRING},done:{type:r.BOOLEAN}}}}}},systemInstruction:[{text:"your work is to parse data given to u into todo list tasks , text should be the title the rest are self explainatory, if the user doesnt not specify deadline use null datatype in its place. deadline and timestamp should be in js new date format, you can research and create detailed multiple todos task based on what the user wants, timestamp should be ".concat(new Date,"\n\n")}]};return await t.models.generateContent({model:"gemini-2.0-flash",config:n,contents:[{role:"user",parts:[{text:e}]}]}).then(e=>{let t=e.text;return console.log(JSON.parse(t).todos),JSON.parse(t)})}function nm(e){try{let t=JSON.parse(e);if(Array.isArray(t))return t.filter(e=>"object"==typeof e&&null!==e&&"text"in e&&"note"in e&&"done"in e&&"timestamp"in e&&"deadline"in e);return[]}catch(e){return[]}}function nh(){let[e,t]=(0,Q.useState)([]),[n,l]=(0,Q.useState)(""),[i,r]=(0,Q.useState)(""),[o,a]=(0,Q.useState)(new Date),[s,u]=(0,Q.useState)(new Z.Time(new Date().getHours(),new Date().getMinutes())),[p,c]=(0,Q.useState)(!1);return(0,Q.useEffect)(()=>{let e=function(e){for(let t of document.cookie.split(";").map(e=>e.trim()))if(t.startsWith(e+"="))return decodeURIComponent(t.substring(e.length+1));return null}("todos");e&&t(nm(e))},[]),(0,Q.useEffect)(()=>{0!==e.length&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:365;try{let l=new Date(Date.now()+24*n*36e5).toUTCString();t.length<4e3?document.cookie="".concat(e,"=").concat(encodeURIComponent(t),"; expires=").concat(l,"; path=/; SameSite=Lax"):document.cookie="".concat(e,"=; expires=").concat(l,"; path=/; SameSite=Lax")}catch(e){console.error("Failed to set cookie:",e)}}("todos",JSON.stringify(nm(JSON.stringify(e))))},[e]),(0,X.jsxs)("div",{className:"font-hand grid grid-rows-[20px_1fr_20px] items-center justify-items-center min-h-screen p-8 pb-20 gap-16 sm:p-20 bg-[length:100%_2.5rem] bg-[linear-gradient(to_bottom,transparent_95%,#d1d5db_95%)]",children:[(0,X.jsx)("div",{className:"fixed translate-x-[-40vw] bg-red-500 h-[100vh] w-[0.2rem]"}),(0,X.jsxs)("main",{className:"flex flex-col gap-[32px] h-[100%] w-[100%] row-start-2 items-center sm:items-start",children:[(0,X.jsx)("h1",{className:"text-8xl font-bold mb-4",children:"Todo App Ai "}),(0,X.jsxs)("form",{className:"flex flex-col gap-4 items-center mb-8",onSubmit:a=>{if(a.preventDefault(),n.trim()){let a=o?new Date(o.getFullYear(),o.getMonth(),o.getDate(),s.hour,s.minute):null;t([...e,{text:n,note:i,done:!1,timestamp:Date.now(),deadline:a}]),l(""),r("")}},children:[(0,X.jsxs)("div",{className:"flex flex-col w-[70vw] gap-2",children:[(0,X.jsx)("span",{className:"text-3xl",children:"Full Task(s) Description :"}),(0,X.jsx)("textarea",{className:"border rounded text-2xl px-2 py-1 min-h-[100px]",placeholder:"Type all your tasks here with deadlines notes etc, ai will parse it...",value:i,onChange:e=>r(e.target.value)})]}),(0,X.jsx)("button",{type:"button",onClick:async()=>{$.toast.promise(nf(i).then(n=>{t([...e,...nm(JSON.stringify(n.todos))])}),{loading:"Processing...",success:(0,X.jsx)("b",{children:"Tasks added!"}),error:(0,X.jsx)("b",{children:"Could not add tasks."})})},className:"bg-primary text-white px-4 py-2 flex items-center text-5xl rounded",children:""})]})]})]})}}]);